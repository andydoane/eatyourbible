<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@400;700&display=swap" rel="stylesheet">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
<title>Ten Commandments</title>

<!-- PWA -->
<link rel="manifest" href="/eatyourbible/pwa/commandments/manifest.webmanifest">
<meta name="theme-color" content="#7f66c6">

<!-- iOS "Add to Home Screen" -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<link rel="apple-touch-icon" href="/eatyourbible/pwa/commandments/icons/icon-192.png">

<style>
/* Global box sizing fix */
*, *::before, *::after { box-sizing: border-box; }

html, body {
  margin: 0;
  padding: 0;
  height: 100%;
  overflow: hidden;
  font-family: "Baloo 2", system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
}

#app { position: relative; width: 100%; height: 100%; overflow: hidden; }

/* ---------- Slide System ---------- */
.slide{
  position:absolute;
  width:100%;
  height:100%;
  top:0; left:0;
  display:flex;
  flex-direction:column;
  min-height:0;
  padding-bottom: calc(70px + env(safe-area-inset-bottom));
}

.slide.nav-hidden{ padding-bottom: env(safe-area-inset-bottom); }

.content{
  flex:1;
  display:flex;
  flex-direction:column;
  min-height:0;
}

.image-area{
  flex:1;
  display:flex;
  justify-content:center;
  align-items:center;
  cursor:pointer;
  min-height:0;
}

.image-area img{
  max-height:100%;
  max-width: min(90vw, 520px);
  object-fit:contain;
}

.text-area{
  flex:1;
  display:flex;
  justify-content:center;
  align-items:center;
  padding:0 20px;
  text-align:center;
  min-height:0;
}

.phrase{
  font-family:'Baloo 2', cursive;
  font-size: clamp(24px, 8vw, 100px);
  text-wrap: balance;
  color:white;
  font-weight:700;
  text-shadow:0 2px 6px rgba(0,0,0,0.4);
}

.dark-text{ color:#111; text-shadow:none; }

.small-text{
  font-size: clamp(16px, 3vw, 20px);
  opacity:.85;
  color:white;
  text-wrap: balance;
}

.large-text{
  font-size: clamp(28px, 6vw, 48px);
  color:white;
  font-weight:700;
  text-wrap: balance;
}

/* ---------- Navigation ---------- */
.nav{
  height:70px;
  background: rgba(0,0,0,0.3);
  display:flex;
  justify-content:space-between;
  align-items:center;
  color:white;
  font-size:28px;
  position:fixed;
  left:0; right:0; bottom:0;
  z-index:9999;
  padding: 0 30px calc(env(safe-area-inset-bottom)) 30px;
}

.nav button{
  background:none;
  border:none;
  color:white;
  font-size:28px;
  display:flex;
  align-items:center;
  justify-content:center;
}

.nav-icon{ width:34px; height:34px; display:block; }

.center-btn{ font-size:18px !important; }

/* Pressable white pill buttons for Hint/Dig Deeper */
.nav-pill{
  background:white !important;
  color:#333333 !important;
  border:none;
  border-radius:999px;
  padding:10px 18px;
  font-size:18px;
  font-weight:700;
  box-shadow:0 4px 0 rgba(0,0,0,0.25);
  transition: transform 0.12s ease, box-shadow 0.12s ease;
}

.nav-pill:active{
  transform: translateY(3px);
  box-shadow:0 1px 0 rgba(0,0,0,0.25);
}

/* ---------- Title ---------- */
.title-screen{
  position:relative;
  display:flex;
  flex-direction:column;
  align-items:center;
  height:100%;
  padding:24px 16px;
  padding-bottom:110px;
  background:#7f66c6;
  color:white;
  text-align:center;
}

.title-content{
  flex:1;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  width:100%;
  max-width:700px;
  padding-bottom:0px;
}

.title-screen h2{
  font-size: clamp(22px, 5.2vw, 44px);
  font-weight:700;
  margin:14px 0 12px;
  text-wrap: balance;
}

.title-screen img{
  width:min(80%, 420px);
  max-height:34vh;
  object-fit:contain;
}

.title-buttons button{
  margin:10px 8px;
  padding:14px 28px;
  font-size:18px;
  font-weight:700;
  border-radius:999px;
  border:none;
  background:white;
  color:#7f66c6;
  box-shadow:0 6px 0 rgba(0,0,0,0.25);
  transition: all 0.15s ease;
}

.title-buttons button:hover{
  transform: translateY(-2px);
  box-shadow:0 8px 0 rgba(0,0,0,0.25);
}

.title-buttons button:active{
  transform: translateY(4px);
  box-shadow:0 2px 0 rgba(0,0,0,0.25);
}

.title-buttons button.carousel-arrow:hover,
.title-buttons button.carousel-arrow:active{
  box-shadow:none;
  transform:none;
}

.learn-btn{ background:white; color:#7f66c6; }
.test-btn{ background:#ffc751; color:#333; }

/* ---------- Title Button Carousel ---------- */
.title-carousel{
  display:flex;
  align-items:center;
  justify-content:center;
  gap:10px;
  width:100%;
}

.title-buttons button.carousel-arrow{
  width:54px;
  height:54px;
  padding:0;
  margin:10px 0;
  border-radius:999px;
  background: rgba(0,0,0,0.30);
  color:white;
  display:flex;
  align-items:center;
  justify-content:center;
  line-height:0;
  font-size:28px;
  font-weight:700;
  box-shadow:none;
  transform:none;
}

.title-buttons button.carousel-main{
  margin:10px 0;
  flex:1;
  min-width:0;
  max-width:420px;
}

.carousel-dots{
  display:flex;
  justify-content:center;
  gap:10px;
  margin-top:6px;
}

.carousel-dot{
  width:10px;
  height:10px;
  border-radius:999px;
  border:2px solid rgba(255,255,255,0.75);
  opacity:0.9;
}

.carousel-dot.active{ background: rgba(255,255,255,0.95); }

/* ---------- Mode Select (title-style buttons) ---------- */
.mode-buttons{
  display:flex;
  flex-direction:column;
  align-items:center;
  width:100%;
  gap:14px;
  margin-top:10px;
}

.mode-buttons button{
  width:min(420px, 92%);
  display:flex;
  flex-direction:column;
  gap:4px;
  line-height:1.1;
}

.mode-buttons .btn-desc{
  font-size:14px;
  font-weight:500;
  opacity:0.85;
}

.hard-btn{ background:#ff5a51; color:white; }

.footer{
  position:absolute;
  left:0; right:0; bottom:0;
  background: rgba(0,0,0,0.30);
  color:white;
  text-align:center;
  padding:12px 16px calc(12px + env(safe-area-inset-bottom));
  font-size:14px;
  line-height:1.2;
  z-index:9999;
}

/* ---------- Intro ---------- */
.intro{
  background:#7f66c6;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100%;
}

.intro img{
  width:60%;
  max-width:400px;
  animation: wiggle 1s infinite alternate;
}

@keyframes wiggle { 0%{transform:rotate(-4deg);} 100%{transform:rotate(4deg);} }

button{ cursor:pointer; font-family:inherit; }

/* Prevent mobile double-tap zoom on specific controls */
.no-zoom{
  touch-action: manipulation;
  -webkit-user-select:none;
  user-select:none;
  -webkit-touch-callout:none;
}

/* ---------- Dig Deeper Overlay ---------- */
.dig-modal{
  position:absolute;
  top:0; left:0; right:0;
  bottom: calc(70px + env(safe-area-inset-bottom));
  z-index: 6000;
  padding: 18px 16px 18px 16px;
}

.dig-modal-inner{
  height:100%;
  width: min(820px, 100%);
  margin: 0 auto;
  border-radius: 24px;
  background: rgba(0,0,0,0.90);
  box-shadow: 0 14px 40px rgba(0,0,0,0.28);
  padding: 18px 16px;
  display:flex;
  flex-direction:column;
  gap: 10px;
}

.dig-modal-title{
  color:white;
  font-weight:700;
  font-size: clamp(18px, 3.8vw, 26px);
  text-shadow:0 2px 6px rgba(0,0,0,0.35);
}

.dig-modal-scroll{
  flex:1;
  min-height:0;
  overflow-y:auto;
  -webkit-overflow-scrolling: touch;

  position: relative;
  padding-bottom: 70px;

  /* Hide scrollbar but keep scrolling */
  scrollbar-width: none;        /* Firefox */
  -ms-overflow-style: none;     /* IE/Edge */
}

.dig-modal-scroll::-webkit-scrollbar{
  display: none;                /* Chrome/Safari */
}

/* Fade overlay that stays pinned to the bottom of the card */
.dig-modal-inner{
  position: relative; /* IMPORTANT: anchors the fade */
}

.dig-fade{
  position:absolute;
  left:16px;
  right:16px;
  bottom:18px;      /* matches .dig-modal-inner padding */
  height:62px;
  pointer-events:none;
  background: linear-gradient(to bottom, rgba(0,0,0,0), rgba(0,0,0,0.90));
}

.dig-p{
  margin: 0 0 24px 0;
  color:white;
  font-size: clamp(16px, 3.6vw, 22px);
  font-weight: 400;
  line-height: 1.55;
  text-shadow:0 2px 6px rgba(0,0,0,0.35);
  text-wrap: pretty;
  text-align: justify;
  hyphens: auto;
  -webkit-hyphens: auto; /* Safari/iOS */
  overflow-wrap: break-word; /* safety for long words */
}

.dig-p strong{
  font-weight: 800;
}


.dig-p strong:first-child{
  font-size: 1.1em;
  letter-spacing: 0.5px;
}

.dig-p em{
  font-style: italic;
  opacity: 0.95;
}
</style>
</head>

<body>
<div id="app"></div>
<div id="navBar" class="nav" style="display:none;"></div>

<script>
/* ---------- Data ---------- */
/*
  Edit these later in VS Code:

  - COMMANDMENTS: text + key words (for Test Yourself masking)
  - DIG_DEEPER_TEXT: one long explanation per commandment
*/

const COMMANDMENTS = [
  ["You shall have no other gods before me.", "gods", "other"],
  ["You shall not make for yourself an image...", "image", "make"],
  ["You shall not misuse the name of the Lord your God...", "name", "Lord", "misuse"],
  ["Remember the Sabbath day by keeping it holy.", "Sabbath", "holy"],
  ["Honor your father and your mother...", "father", "mother"],
  ["You shall not murder", "murder"],
  ["You shall not commit adultery.", "adultery"],
  ["You shall not steal", "steal"],
  ["You shall not give false testimony against your neighbor.", "false", "neighbor"],
  ["You shall not covet... anything that belongs to your neighbor", "covet", "belongs"]
];

// One explanation per commandment (Option A)
// Use \\n\\n to create paragraph breaks.
const DIG_DEEPER_TEXT = [];


DIG_DEEPER_TEXT[0] = `**FIRST COMMANDMENT**

**What This Commandment Means:**

*To worship God only.*

The first commandment is part of the first pack of commandments, a group we call the “First Table of God's Law.” That means it is a command that teaches us how to love God with all of our hearts.

Let's look at what the commandment actually says. In Exodus 20:3, God commands us, *“You shall have no other gods before me.”* This commandment makes a lot of sense. After all, way back in question four, we learned that there is only one God. All the other “gods” are worthless, made up in the heads of people and crafted into idols of wood, metal, or stone. We should only worship God because he’s the only God that actually exists!

What exactly is worship? Well, our Bibles use that word to mean lots of things. Sometimes “worship” means to bow down. Other times, it means to obey. In some places, it means to give glory and praise to someone. When it comes to the first commandment, the big idea here is to give God your complete loyalty and allegiance, making him the #1 most important person in your life. God is the only one worthy of our worship – we shouldn’t share a single drop with any “god,” anyone, or anything else!

We obey the first commandment when we live like God is our one and only king. We give God our best worship when we treat him as the greatest treasure of all, a million times more valuable and worthy of our attention than anything else. We can demonstrate this by singing him songs of praise and following his commands. When we do the opposite, if we give our worship to anything or anyone else, we break the first commandment. If we treat any created thing (friends, money, stuff) like it’s our greatest treasure, we are giving away worship that belongs only to our great and glorious God!`;


DIG_DEEPER_TEXT[1] = `**SECOND COMMANDMENT**

**What This Commandment Teaches Us:**

*To worship God in the right way and to avoid idolatry.*

Commandment #2 is part of the “First Table of the Law.” It’s one of the four commands that teach us how to love God with all of our hearts. In Exodus 20:4, God says, *“You shall not make for yourself an image in the form of anything in heaven above or on the earth beneath or in the waters below. You shall not bow down to them or worship them…”*

Back in question six, we learned that God is a spirit. He does not have a flesh-and-bone body like you and I do. Since God isn’t made up of “stuff,” the Israelites couldn’t see him with their eyes or touch him with their hands. That was something they didn’t like very much – all the nations around them were able to see their “gods” So God’s people foolishly decided it would be a good idea to make their invisible God visible. They built idols: statues of wood, stone, or metal they could see and touch as they worshiped. This was a dreadful decision, and some of those foolish Israelites paid for it with their lives!

God is our Creator, and we are his creatures. He's in charge of choosing how he wants to be worshiped. In his God-breathed Word, he’s given us instructions on how to worship him. We can sing to him in song. We can talk to him in prayer. And we can live our lives obeying his commands. But carving stone statues or painting pretty pictures of him to bow down to and worship? That's totally off limits! No statue of stone or painted picture could ever compare to the glory of our great God! In fact, God is insulted by the very idea of it!

When we worship God, we shouldn’t try to make images of him with our hands. And we shouldn’t try to imagine pictures of him in our minds, either. We’d be wasting our time – anything we came up with couldn’t possibly come close to the real thing! To be honest, the pictures of God we imagine in our minds are usually pretty lame anyway. God is way better than some old man in the clouds with a long white beard!

The only image of God we ever needed was the one God gave us himself. Colossians 1:15 calls Jesus *“the image of the invisible God...”* By coming to earth to live as a human among us, Jesus was the image of God people could finally see! Unlike the lifeless idols made by the Israelites, Jesus had eyes that could actually see, ears that could actually hear, and hands that could actually hug!`;


DIG_DEEPER_TEXT[2] = `**THIRD COMMANDMENT**

**What This Commandment Teaches Us:**

*To respect God’s name, word, and works.*

The third commandment is part of the First Table of God's Law. And remember what that means – it's designed to teach us how to love God with all of our hearts. We can read it in Exodus 20:7. God commands, *“You shall not misuse the name of the Lord your God, for the Lord will not hold anyone guiltless who misuses his name.”*

Did you ever think about the fact that everything God created has a name? I mean, how could you talk about something if you didn’t have a name for it? Names are important, especially for people. Your name is a special label that represents who you are, sort of like how a flag represents a country. Making fun of someone’s name would be like going to another country, throwing their flag on the ground, and spitting on it! When people mistreat our names, it hurts because they’re really mistreating us!

Every human being is precious and valuable, but none of us can compare to the glory of the great God who made us. That makes his name more special than any name we could possibly imagine. In the third commandment, God commands us to not take his name in vain. In other words, God doesn’t want us to treat his special name as if it were something empty, worthless, or simply not that important.

When we speak about God’s name, when we talk about the words he’s said, when we tell the true tales about the things he has done, we should speak with special care and honor. After all, we’re talking about our glorious Creator! No one and nothing in all of the universe is more worthy of honor and glory and praise than he is! God’s name, his Word, and his mighty miracles are way too important for us to ever joke about!

There are many different ways people break the third commandment. Some people speak God’s name like it’s a swear word when they get angry. Other people will say things like, “I swear to God!” They are using God’s name a bit like a magic word to make you believe them. Even worse, some people will claim to be Christians (believers in Jesus), but live their lives in a way that brings shame to the name of Christ. All of these ways and more bring dishonor to the most special name of our most special God!`;


DIG_DEEPER_TEXT[3] = `**FOURTH COMMANDMENT**

**What This Commandment Teaches Us:**

*To keep the Sabbath holy through prayer and praise, hearing and reading God’s Word, and in doing good to our fellow men.*

The fourth commandment is the last commandment in the First Table of the Law. That means it’s the last commandment that teaches us how to love God with all of our hearts. Listen to what Exodus 20:8-10 tells us: “Remember the Sabbath day by keeping it holy. Six days you shall labor and do all your work, but the seventh day is a sabbath (rest) to the Lord your God. On it you shall not do any work, neither you, nor your son or daughter, nor your male or female servant, nor your animals, nor any foreigner residing in your towns.”

When God created our universe, he didn’t make everything all at once. Over the course of six days, he formed and filled his brand-new world, adding wonderful new creations each and every day. On the sixth day, God finished his universe construction project. So what did he do the next day? The Bible tells us God rested from his work. Was he worn out? Did he need a nap? Nope – our all-powerful, omnipotent God doesn’t get tired!

God rested on the seventh day to set an example for his people. Just like he rested on the last day of his creation week, God commanded his people to do the same. He told them to take a “sabbath,” an old word from the Hebrew language that means “rest.” The Sabbath day was designed to be a day of rest and worship. As they enjoyed a break from their work, God’s people had time to focus on their Creator: to worship him for who he was and thank him for the amazing ways he cared for them. This rest was for everyone. It didn’t matter if you were rich or poor, an Israelite or a foreigner, or even if you were a cow – everybody got to take a break on the Sabbath!

For about 1,500 years, God’s people enjoyed a Sabbath rest every Saturday. But all that changed because of Jesus. After dying on the cross to pay the price for our sins, Jesus took his final breath on a sad Friday afternoon. But no grave could hold the Son of God! On an unforgettable Sunday morning, Jesus rose back to life!

After witnessing that amazing miracle, God’s people started doing something incredible – they shifted their Sabbath day of rest and worship from the last day of the week (Saturday) to the first (Sunday). They even had a special name for that day: they called it “the Lord’s Day” (Rev. 1:10) because it was the day the Lord Jesus rose from the dead.

2000 years later, God’s people still do many of the same things the Israelites did so many years ago. They rest from their work and gather to worship God. They pray together and sing God’s praises. And they enjoy the preaching of God’s Word.

But as they gather each Lord’s Day, they have something brand new to praise God for. Because Jesus finished his work of saving us from our sins, we have the hope of spending forever with God, where every day will be a sabbath, an endless rest in paradise! (Heb. 4:10-11) By gathering to remember what Jesus did to earn us that forever rest, we can honor God’s command to keep the Sabbath.`;


DIG_DEEPER_TEXT[4] = `**FIFTH COMMANDMENT**

**What This Commandment Teaches Us:**

*To love and obey our parents.*

The fifth commandment is the first commandment in the Second Table of the Law. With all those numbers, it’s hard to keep things straight! But if you remember, the Second Table of the Law combines the last six commands. When you put them all together, these laws teach us to love our neighbors as we love ourselves. And God starts off the Second Table of the Law by talking about two special neighbors he wants us to love: our parents! In Exodus 20:12, he commands, *“Honor your father and your mother, so that you may live long in the land the Lord your God is giving you.”*

If he wanted to, God could have designed every human baby to just suddenly pop into our world. From that moment on, he could spend day after day teaching us all about who he is, how his world works, and how we’re supposed to behave. But God didn’t do that. Instead, he designed moms and dads to do that job for him!

After speaking his laws to his people, God gave one extra command to each and every parent. We can read it in Deuteronomy 6:6-7. He said, *“These commandments that I give you today are to be on your hearts. Impress them on your children. Talk about them when you sit at home and when you walk along the road, when you lie down and when you get up.”* Here, God gives every parent a critical mission: to try their absolute best to make sure their little ones understand God’s laws. They are to chat about commands with their children constantly: from breakfast time to bedtime, at home and on the road, any time and anywhere!

Here’s what makes the fifth commandment so important. A parent’s job is to make sure their kids understand and follow God’s commands. So a good and godly parent will teach their children to obey God’s laws. When children obey and honor their godly mothers and fathers, they are actually obeying their Father in Heaven! The fifth commandment is so important because parents are God’s plan to make sure everyone knows all of his other commands!`;


DIG_DEEPER_TEXT[5] = `**SIXTH COMMANDMENT**

**What This Commandment Teaches Us:**

*To avoid hatred, all that leads to it, and all that follows from it.*

The sixth commandment is part of the Second Table of the Law. That means it’s a command designed to teach us a specific way to obey the Golden Rule: “do unto others what you would have them do unto you!” It’s a simple, short, and serious command. Exodus 20:13 says, *“You shall not murder.”*

Pretty much everyone in the world agrees that this is a good command. After all, you can’t love your neighbor and murder them at the same time! There’s not a country in the world that says, “Go ahead and murder each other – it isn’t against the law here!” No, if you get caught taking another person’s life, they’ll throw your backside in prison and throw away the key!

If you asked most people about the sixth commandment, they probably would say, “Of course I’ve obeyed it perfectly – I’ve never murdered anybody!” However, once you hear what Jesus said about the sixth commandment, you’ll understand that everyone, including you and me, is guilty of murder!

In Matthew 5:21-22, Jesus explained, *“You have heard that it was said to the people long ago, ‘You shall not murder, and anyone who murders will be subject to judgment.’ But I tell you that anyone who is angry with a brother or sister will be subject to judgment.”* Did you understand what Jesus is telling us here? If we’ve ever been so angry with someone that our hearts were filled with hatred towards them, Jesus says that we are just as guilty as a murderer! We may not have harmed them with our hands, but we’ve murdered them in our minds with hatred in our hearts. 1 John 3:15 goes on to explain, *“Anyone who hates a brother or sister is a murderer…”* Based on that, every single one of us has broken the sixth commandment! We are all killers in our hearts!

Remember, the last six commandments, including this one, are part of the Second Table of the Law. They are commands that teach us how to love our neighbors. Well, what’s the opposite of love? It’s hate! And hatred in our hearts is the seed that grows into the monster of murder! It’s impossible to love our neighbors if we hatefully slay them with anger in our hearts!`;


DIG_DEEPER_TEXT[6] = `**SEVENTH COMMANDMENT**

**What This Commandment Teaches Us:**

*To be pure in heart, language, and action.*

The seventh commandment, as you know by now, is part of the Second Table of the Law. It’s yet another example of a way for us to love our neighbors like we love ourselves. This command is another short and simple one. In Exodus 20:14, God commands, *“You shall not commit adultery.”*

Adultery is a word mostly used by adults, not kids. But the word “adultery” isn’t about being an adult. Instead, it’s a label for a serious sin: breaking God’s plan for marriage! You don’t have to read very far into the Bible to understand God’s good design for marriage. After making our first father Adam, God created a special helper for him, a perfect partner. And that special helper was our first mother, Eve. Right after God introduced our first parents to each other, Genesis 2:24 says something special about Adam and Eve: *“That is why a man leaves his father and mother and is united to his wife, and they become one flesh.”*

God’s plan for marriage is pretty simple: one man and one woman come together and make a “covenant,” a super-special promise to each other. In a marriage covenant, two people come together to become one. A husband and wife promise to stick together for the rest of their lives, to love and take care of each other. They also promise to save their most special smooches and hugs and other “mom-and-dad things” only with each other.

Human beings have come up with a lot of different ways to mess up God’s good design for marriage. Sometimes, a man decides he wants two or three wives instead of just one. Other times, a man will decide he wants to marry another man instead of a woman. But it doesn’t matter how many different versions of “marriage” humans come up with, there’s only one Person’s opinion we should care about: God’s! And he’s made it clear to us in his Word: a marriage must be between one man and one woman. If we think we have a better design for marriage than God, we are headed straight for disaster!

Adultery is when someone breaks this God-given plan for marriage. When a husband or wife shares their special smooches, hugs, and other “mom-and-dad things” with someone they aren’t married to, they commit the sin of adultery. They’ve broken their marriage covenant promise to their partner. But this commandment isn’t just for married people. When anyone does the special things that only married people should do, they have also broken the seventh commandment.

If you asked most people, “Have you committed adultery?” they would probably say, “No.” But just like we learned in the last question, the seventh commandment is one that we can break inside of our hearts. In Matthew 5:27-28, Jesus tells us, *“You have heard that it was said, ‘You shall not commit adultery.’ But I tell you that anyone who looks at a woman lustfully has already committed adultery with her in his heart.”*

To “look at someone lustfully” means to imagine giving them the special smooches and hugs and “mom-and-dad things” that only a husband and wife should share together. When a man or woman looks at someone else and thinks about doing these marriage-type things, they’ve committed adultery and broken the seventh commandment inside their hearts.

To obey the seventh commandment, God wants us to live pure lives. Just like you wouldn’t want a glass of apple juice mixed with a spoonful of dirt, we don’t want lust to be mixed in with our thoughts, words, and actions. When men and women interact with each other, the words they say should be pure and loving. The same goes for their thoughts and their actions. In 1 Timothy 5:1-2, Paul explains how we should act towards each other: *“Treat younger men as brothers, older women as mothers, and younger women as sisters, with absolute purity.”*`;


DIG_DEEPER_TEXT[7] = `**EIGHTH COMMANDMENT**

**What This Commandment Teaches Us:**

*To be honest and not to take the things of others.*

I bet you know the drill by now – the eighth commandment is part of the Second Table of the Law. And what do all the Second Table commandments point to? The Second Great Commandment, which teaches us to love our neighbor as we love ourselves. In Exodus 20:15, God commands us, *“You shall not steal.”*

The eighth commandment teaches us “to be honest and not to take the things of others.” That answer might seem a little strange. When we think of the word “honest,” we normally think about telling the truth. Did this answer get put in the wrong place? Was it supposed to go with the ninth commandment, the one about lying? What does honesty have to do with God’s command to not steal?

To be honest means much more than being someone who tells the truth. It comes from the word “honor.” That makes sense – they both begin with the same letters! An honest person is someone who behaves honorably. They are someone you would trust to keep your stuff safe, not steal it.

If your grandma gave you a $20 bill for your birthday and you left it lying out on a table, an honest person wouldn’t take it. In fact, they’d probably tell you to put it in a safe place before someone else steals it! That’s exactly the kind of people God wants us to be – honest people who don’t take what doesn’t belong to them.

In Exodus 23:4, God gives an example of what an honest person looks like. *“If you come across your enemy’s ox or donkey wandering off, be sure to return it.”* As his children, God doesn’t want us to live by the law of Finders Keepers. If we find something that doesn’t belong to us, we shouldn’t be like, “Oh, it’s my lucky day!” No, we should do what we would want others to do in that situation. If you left your favorite stuffed animal at the park, would you want the person who found it to follow the rules of Finders Keepers? No, you’d want them to track you down and give your stuffed friend back to you!

God wants more from his people than just to not be sticky-fingered thieves. In Ephesians 4:28, we learn, *“Anyone who has been stealing must steal no longer, but must work, doing something useful with their own hands, that they may have something to share with those in need.”* Instead of being grabbers and takers, God wants us to be givers and sharers. God desires his children to be honest, hard-working people who share our belongings with those in need. The eighth commandment is more than just “Do not steal;” it’s also “Do share.”`;


DIG_DEEPER_TEXT[8] = `**NINTH COMMANDMENT**

**What This Commandment Means:**

*To tell the truth and not to speak evil of others.*

The ninth commandment sits down near the bottom of the Ten Commandments, but that doesn’t mean it isn’t as important as all the others. It’s part of the second half of the Ten Commandments, a group we nickname “the Second Table of the Law.” As you’ve learned over and over again at this point, that means it teaches us a way to love our neighbors as we love ourselves. In Exodus 20:16, God commands, *“You shall not give false testimony against your neighbor.”*

When most of us think of the ninth commandment, we think it says, “Do not lie.” But the words we read in our Bibles actually tell us to not give “false testimony.” To understand what the word “testimony” means, we need to talk about courts and judges.

A court is a place where people meet to solve disagreements and arguments about the law. A courtroom is ruled over by a judge. Their job is to figure out the truth about what happened. If they discover someone broke the law, their duty is to punish the evil doer and force them to take the wrong thing they have done and make it right.

Part of figuring out the truth is listening to witnesses: people who saw a crime happen. A witness stands in front of a judge and gives their “testimony.” That means they tell the judge everything they saw. Sadly, sometimes witnesses would give false testimony – they would lie about what really happened, either to protect themselves or a criminal friend. To put it in simple words, they would lie right to the judge’s face!

In the ninth commandment, God tells us to not give false testimony. We shouldn’t lie about what has happened. Whether we are standing before a judge in a courtroom or in front of your mom and dad in your living room, we must always speak the truth. The words we say need to match up with what actually happened. It doesn’t matter if it’s about something small or big. If you tell a “little white lie” or a big whopper, that still makes you a liar!

Instead of lying, Ephesians 4:25 commands us to do the opposite: *“Therefore each of you must put off falsehood and speak truthfully to your neighbor, for we are all members of one body.”* It’s impossible to love your neighbor if you are lying to them or about them. So no matter the situation, big or small, we should tell the truth! But remember: the ninth commandment is all about love. Not only should the words that escape our lips be true words – they should also be loving words!`;


DIG_DEEPER_TEXT[9] = `**TENTH COMMANDMENT**

**What This Commandment Teaches Us:**

*To be content with what we have..*

We’ve done it – we’ve reached the last of the Ten Commandments. But even though it’s at the end of the list, the tenth commandment is still part of the Second Table of the Law. So that means… well, I bet you know where I’m going: it teaches us how to love our neighbors as we love ourselves! In Exodus 20:17, God commands, *“You shall not covet your neighbor’s house. You shall not covet your neighbor’s wife, or his male or female servant, his ox or donkey, or anything that belongs to your neighbor.”*

“Covet” is a word that we don’t use very much. If you looked the word up in a dictionary, you would learn that it means to really, really, really want something someone else has – to want it so much that you moan and groan and make yourself and those around you miserable! Here’s a little rhyme to help you remember what it means to covet: “I like it, I love it, it makes me want to covet!”

In the tenth commandment, there’s a whole list of things people coveted back in the time of Moses. They would complain that their neighbor had a better house, a cuter wife, and a stronger donkey than they did. But whining and complaining about anything you don’t have is still coveting. From video games to cars to big muscles… if we’re miserable about not having it, we are breaking the tenth commandment.

Instead of complaining and coveting, the answer to this question tells us to “be content with what we have.” To be content is to be satisfied, sort of how your tummy feels after a great big meal. The apostle Paul talks about being content in Philippians 4:11-12: “I have learned to be content whatever the circumstances. I know what it is to be in need, and I know what it is to have plenty. I have learned the secret of being content in any and every situation, whether well fed or hungry, whether living in plenty or in want.”

According to Paul, it’s possible to be content in every situation. Stuffed or starving, healthy or sick, free or in prison – Paul experienced all these situations. No matter where we find ourselves, Paul makes it clear. The answer is always the same: to be content, not to covet!`;



const slideColors = [
  "#7f66c6", // 1 - purple
  "#ffc751", // 2 - yellow
  "#333333", // 3 - gray
  "#ffa351", // 4 - orange
  "#a7cb6f", // 5 - green
  "#ff5a51", // 6 - red
  "#40b9c5", // 7 - blue
  "#f2f2f2", // 8 - white
  "#7f66c6", // 9 - purple
  "#ffc751"  // 10 - yellow
];

let screen="intro";
let index=0;
let muted=false;
let testMode=null;
let hintState=0;
let learnIntro=false;
let digIntro=false;
let isSliding=false;

// Dig Deeper state
let digDeeperOpen=false;

// ---------- Title carousel ----------
let titleOptionIndex=0;

const TITLE_OPTIONS = [
  { label: "Learn the Commands", btnClass: "learn-btn", action: "startLearn" },
  { label: "Test Yourself",      btnClass: "test-btn",  action: "modeSelect" },
  { label: "Dig Deeper",         btnClass: "learn-btn", action: "startDigDeeper" }
];

function titlePrevOption(){
  titleOptionIndex = (titleOptionIndex - 1 + TITLE_OPTIONS.length) % TITLE_OPTIONS.length;
  updateTitleCarouselUI();
}
function titleNextOption(){
  titleOptionIndex = (titleOptionIndex + 1) % TITLE_OPTIONS.length;
  updateTitleCarouselUI();
}
function runTitleOption(){
  const opt = TITLE_OPTIONS[titleOptionIndex];
  window[opt.action]();
}
function updateTitleCarouselUI(){
  const opt = TITLE_OPTIONS[titleOptionIndex];
  const mainBtn = document.getElementById("titleMainBtn");
  const indicator = document.getElementById("titleIndicator");

  if (mainBtn){
    mainBtn.textContent = opt.label;
    mainBtn.className = `carousel-main ${opt.btnClass}`;
  }
  if (indicator){
    indicator.innerHTML = TITLE_OPTIONS.map((_, i) =>
      `<span class="carousel-dot ${i === titleOptionIndex ? "active" : ""}"></span>`
    ).join("");
  }
}

// --- Inline SVG icons (copied from your original file) ---
const SVG_BACK = `
<svg class="nav-icon" viewBox="0 0 1270 889" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false">
  <path style="fill:#ffffff;stroke-width:74.9031;stroke-linecap:round"
    d="M 90.101697,426.07323 665.52324,88.164306 a 20.830539,20.830539 29.78848 0 1 31.37872,17.962384 v 676.74658 a 20.830539,20.830539 150.21152 0 1 -31.37872,17.96238 L 90.101697,462.92673 a 21.369052,21.369052 90 0 1 0,-36.8535 z"
    transform="translate(246.77226)" />
</svg>`;

const SVG_FORWARD = `
<svg class="nav-icon" viewBox="0 0 1270 889" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false">
  <path style="fill:#ffffff;stroke-width:74.9031;stroke-linecap:round"
    d="M 90.101697,426.07323 665.52324,88.164306 a 20.830539,20.830539 29.78848 0 1 31.37872,17.962384 v 676.74658 a 20.830539,20.830539 150.21152 0 1 -31.37872,17.96238 L 90.101697,462.92673 a 21.369052,21.369052 90 0 1 0,-36.8535 z"
    transform="matrix(-1,0,0,1,1023.2277,0)" />
</svg>`;

const SVG_UNMUTE = `
<svg class="nav-icon" viewBox="0 0 1270 889" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false">
  <g transform="matrix(2.9017243,0,0,2.9017243,-948.59169,1423.6267)">
    <path style="fill:#ffffff;stroke:none;stroke-width:15.4884;stroke-linecap:round"
      d="m 554.69651,-460.54773 -86.50507,53.22802 a 51.858137,51.858137 0 0 1 -27.17654,7.69139 h -36.35067 a 14.676664,14.676664 0 0 0 -14.67666,14.67666 v 95.04477 a 14.676664,14.676664 0 0 0 14.67666,14.67666 h 36.35067 a 51.858137,51.858137 0 0 1 27.17654,7.69139 l 86.50507,53.22802 a 8.2017227,8.2017227 0 0 0 12.49988,-6.98527 v -232.26637 a 8.2017227,8.2017227 0 0 0 -12.49988,-6.98527 z" />
    <path style="fill:none;stroke:#ffffff;stroke-width:26.4583;stroke-linecap:round;stroke-dasharray:none;stroke-opacity:1"
      d="m 596.38634,-270.01659 c 26.00162,-13.81364 42.0863,-39.52797 42.16745,-67.41243 -0.0102,-27.95044 -16.10446,-53.75052 -42.16745,-67.5969" />
    <path style="fill:none;stroke:#ffffff;stroke-width:26.4583;stroke-linecap:round;stroke-dasharray:none;stroke-opacity:1"
      d="m 626.65943,-233.57231 c 4.34269,-2.51562 16.69789,-10.99898 23.86366,-17.76894 23.32002,-22.03191 37.74343,-52.46821 37.74343,-86.08777 0,-33.61956 -14.42341,-64.05637 -37.74343,-86.08828 -7.16577,-6.76996 -19.52097,-15.25332 -23.86366,-17.76894" />
  </g>
</svg>`;

const SVG_MUTE = `
<svg class="nav-icon" viewBox="0 0 1270 889" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false">
  <path style="fill:#ffffff;stroke:none;stroke-width:44.9431;stroke-linecap:round"
    d="M 660.98465,87.244161 409.97079,241.6972 a 150.47802,150.47802 0 0 1 -78.85883,22.31829 H 225.63234 a 42.587633,42.587633 0 0 0 -42.58762,42.58762 v 275.79372 a 42.587633,42.587633 0 0 0 42.58762,42.58762 h 105.47962 a 150.47802,150.47802 0 0 1 78.85883,22.3183 l 251.01386,154.45304 a 23.799138,23.799138 0 0 0 36.27121,-20.26933 V 107.51349 A 23.799138,23.799138 0 0 0 660.98465,87.244161 Z" />
  <g transform="translate(-26.458334,-255.59263)">
    <path style="fill:none;stroke:#ffffff;stroke-width:76.7747;stroke-linecap:round;stroke-dasharray:none;stroke-opacity:1"
      d="M 1241.4124,524.69155 890.61025,875.49365" />
    <path style="fill:none;stroke:#ffffff;stroke-width:76.7747;stroke-linecap:round;stroke-dasharray:none;stroke-opacity:1"
      d="m 890.61025,524.69155 350.80215,350.8021" />
  </g>
</svg>`;

const SVG_HOME = `
<svg class="nav-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false">
  <path d="M12 3L3 10h2v9h5v-6h4v6h5v-9h2L12 3z" fill="#ffffff"/>
</svg>`;

// Reuse one audio player (keeps behavior identical; safe if you later add audio)
const audioPlayer = new Audio();
audioPlayer.preload = "auto";
let audioUnlocked = false;

/* ---------- Utility ---------- */
function getColor(i){ return slideColors[i]; }
function isLightBg(color){ return color === "#ffc751" || color === "#f2f2f2"; }

function setNav(html){
  const nav = document.getElementById("navBar");
  if (!nav) return;
  if (!html){
    nav.style.display="none";
    nav.innerHTML="";
    return;
  }
  nav.style.display="flex";
  nav.innerHTML=html;
}

function preloadCommandmentImages(priorityCount=3){
  function requestImage(src){
    const img = new Image();
    img.src = src;
    img.decoding="async";
  }

  // Intro images (optional; keep same pattern as your creed app)
  requestImage("commandment_images/intro_bible.png");
  requestImage("commandment_images/intro_bible_bite.png");

  // Title/end image
  requestImage("commandment_images/commandment_title.png");

  const total = COMMANDMENTS.length;
  const firstBatch = Math.min(priorityCount, total);

  for (let i=1; i<=firstBatch; i++){
    requestImage(`commandment_images/commandment_${String(i).padStart(2,"0")}.png`);
  }

  function preloadRemaining(){
    for (let i=firstBatch+1; i<=total; i++){
      requestImage(`commandment_images/commandment_${String(i).padStart(2,"0")}.png`);
    }
  }

  if ("requestIdleCallback" in window){
    requestIdleCallback(preloadRemaining, {timeout:1500});
  } else {
    setTimeout(preloadRemaining, 300);
  }
}

function setupKeyboardNav(){
  document.addEventListener("keydown", (e) => {
    if (e.repeat) return;
    if (e.key !== "ArrowRight" && e.key !== "ArrowLeft") return;

    // Prevent page from scrolling
    e.preventDefault();

    // Dig Deeper open = no keyboard nav
    if (screen === "dig" && digDeeperOpen) return;

    if (e.key === "ArrowRight"){
      if (screen === "learn"){
        if (learnIntro) nextLearn("forward");
        else forwardLearn();
      } else if (screen === "test"){
        forwardTest();
      } else if (screen === "dig"){
        if (digIntro) beginDigDeeper();
        else forwardDigDeeper();
      }
      return;
    }

    if (e.key === "ArrowLeft"){
      if (screen === "learn"){
        if (learnIntro) titleScreen();
        else prevLearn();
      } else if (screen === "test"){
        prevTest();
      } else if (screen === "dig"){
        if (digIntro) titleScreen();
        else prevDigDeeper();
      }
    }
  });
}

function preventDoubleTapZoomOnButtons(){
  let lastTouchEnd=0;
  document.addEventListener("touchend", (e) => {
    const btn = e.target.closest(".no-zoom");
    if (!btn) return;

    const now = Date.now();
    if (now - lastTouchEnd <= 350) e.preventDefault();
    lastTouchEnd = now;
  }, { passive:false });
}

function playAudio(i){
  if (muted) return;
  audioPlayer.pause();
  audioPlayer.currentTime = 0;
  audioPlayer.src = `commandment_audio/commandment_${String(i+1).padStart(2,"0")}.mp3`;
  audioPlayer.volume = 1;
  audioPlayer.play().catch(()=>{});
}

function unlockAudioForIOS(){
  if (audioUnlocked) return;
  audioPlayer.src = `commandment_audio/silence.mp3`;
  audioPlayer.volume = 0;
  const p = audioPlayer.play();
  if (p && typeof p.then === "function"){
    p.then(()=>{
      audioPlayer.pause();
      audioPlayer.currentTime = 0;
      audioPlayer.volume = 1;
      audioUnlocked = true;
    }).catch(()=>{});
  }
}

/* ---------- Test Masking ---------- */
function maskWord(word, revealLetters=0){
  return word.split("").map((c,i)=>{
    if (c===" ") return " ";
    if (i<revealLetters) return word[i];
    return "_";
  }).join("");
}

function maskPhrase(phrase, removeWords, reveal=0){
  let result = phrase;
  removeWords.forEach(w=>{
    if (!w) return;
    const masked = reveal===2 ? w : reveal===1 ? maskWord(w,1) : maskWord(w,0);
    result = result.replace(new RegExp(w,"i"), masked);
  });
  return result;
}

function computeTestDisplayPhrase(){
  const phraseData = COMMANDMENTS[index];
  const phrase = phraseData[0];

  let remove = [];
  if (testMode === "easy") remove = [phraseData[1]];
  if (testMode === "medium") remove = phraseData.slice(1);

  if (testMode === "hard" && hintState === 0) return "";
  if (testMode === "hard" && hintState === 1) return maskPhrase(phrase, phraseData.slice(1), 0);
  if (testMode === "hard" && hintState === 2) return phrase;

  return maskPhrase(phrase, remove, hintState);
}

function updateTestHintUI(){
  const phraseEl = document.getElementById("testPhrase");
  if (phraseEl) phraseEl.textContent = computeTestDisplayPhrase();

  const hintBtn = document.getElementById("hintBtn");
  if (hintBtn) hintBtn.textContent = (hintState === 0) ? "Hint" : "Reveal";
}

/* ---------- Slide Engine ---------- */
function showSlide(contentHTML, bgColor, direction="forward"){
  const app = document.getElementById("app");

  // Remove any non-slide screens (like title/mode screens)
  [...app.children].forEach(child=>{
    if (!child.classList || !child.classList.contains("slide")) child.remove();
  });

  if (direction !== "none" && isSliding) return;

  const slides = app.querySelectorAll(".slide");
  const oldSlide = slides.length ? slides[slides.length - 1] : null;

  for (let i=0; i<slides.length-1; i++) slides[i].remove();

  const newSlide = document.createElement("div");

  const nav = document.getElementById("navBar");
  const navHidden = !nav || nav.style.display === "none";

  newSlide.className = navHidden ? "slide nav-hidden" : "slide";
  newSlide.style.background = bgColor;
  newSlide.innerHTML = contentHTML;
  newSlide.style.transition = "none";

  if (direction === "back") newSlide.style.transform = "translateX(-100%)";
  else if (direction === "none") newSlide.style.transform = "translateX(0)";
  else newSlide.style.transform = "translateX(100%)";

  app.appendChild(newSlide);
  newSlide.offsetHeight;

  if (direction === "none"){
    if (oldSlide) oldSlide.remove();
    isSliding = false;
    return;
  }

  isSliding = true;

  requestAnimationFrame(()=>{
    requestAnimationFrame(()=>{
      newSlide.style.transition = "transform .4s ease";
      newSlide.style.transform = "translateX(0)";

      if (oldSlide){
        oldSlide.style.transition = "transform .4s ease";
        oldSlide.style.transform = (direction === "back") ? "translateX(100%)" : "translateX(-100%)";
      }

      setTimeout(()=>{
        if (oldSlide) oldSlide.remove();
        isSliding = false;
      }, 410);
    });
  });
}

/* ---------- Screens ---------- */
function introScreen(){
  const html = `
    <div class="intro">
      <img id="introImg" src="commandment_images/intro_bible.png">
    </div>`;
  document.getElementById("app").innerHTML = html;
  setNav("");

  const img = document.getElementById("introImg");
  img.onclick = ()=>{
    img.src = "commandment_images/intro_bible_bite.png";
    new Audio("commandment_audio/chomp.mp3").play().catch(()=>{});
    setTimeout(()=>titleScreen(), 600);
  };
}

function titleScreen(){
  screen="title";
  const html = `
    <div class="title-screen">
      <div class="title-content" id="titleContent">
        <img src="commandment_images/commandment_title.png">
        <h2>Let&apos;s Learn the Ten Commandments</h2>

        <div class="title-buttons">
          <div class="title-carousel">
            <button class="carousel-arrow no-zoom" onclick="titlePrevOption()" aria-label="Previous option">◀</button>

            <button id="titleMainBtn" class="carousel-main learn-btn" onclick="runTitleOption()">
              Learn the Commands
            </button>

            <button class="carousel-arrow no-zoom" onclick="titleNextOption()" aria-label="Next option">▶</button>
          </div>

          <div class="carousel-dots" id="titleIndicator"></div>
        </div>
      </div>

      <div class="footer">
        More free Bible resources at:<br>
        <a href="https://www.eatyourbible.com" target="_blank" style="color:white;">
        www.eatyourbible.com</a>
      </div>
    </div>`;
  document.getElementById("app").innerHTML = html;
  setNav("");
  updateTitleCarouselUI();
}

/* ---------- Learn Mode ---------- */
function startLearn(){
  unlockAudioForIOS();
  screen="learn";
  index=0;
  showLearnIntro();
}

function showLearnIntro(){
  learnIntro = true;
  setNav("");
  showSlide(`
    <div class="content">
      <div class="text-area">
        <div>
          <div class="large-text">Let&apos;s read the Ten Commandments.</div>
          <div class="small-text">Use the arrows to go forward and back.</div>

          <div class="title-buttons">
            <button class="learn-btn" onclick="nextLearn('forward')">Begin</button>
          </div>
        </div>
      </div>
    </div>`, "#7f66c6");
}

function nextLearn(direction="forward"){
  learnIntro = false;
  if (index >= COMMANDMENTS.length){
    showLearnEnd();
    return;
  }

  const phrase = COMMANDMENTS[index][0];
  const color = getColor(index);
  const textClass = isLightBg(color) ? "phrase dark-text" : "phrase";

  const html = `
    <div class="content">
      <div class="image-area" onclick="forwardLearn()">
        <img src="commandment_images/commandment_${String(index+1).padStart(2,'0')}.png">
      </div>
      <div class="text-area">
        <div class="${textClass}">${phrase}</div>
      </div>
    </div>
  `;

  setNav(`
    <button class="no-zoom" onclick="prevLearn()" aria-label="Back">${SVG_BACK}</button>

    <button class="no-zoom" onclick="titleScreen()" aria-label="Home">
      ${SVG_HOME}
    </button>

    <button class="center-btn" id="muteBtn" onclick="toggleMute()" aria-label="Mute toggle">
      ${muted ? SVG_MUTE : SVG_UNMUTE}
    </button>

    <button class="no-zoom" onclick="forwardLearn()" aria-label="Forward">${SVG_FORWARD}</button>
  `);

  showSlide(html, color, direction);
  playAudio(index);
}

function forwardLearn(){
  index++;
  nextLearn("forward");
}

function prevLearn(){
  if (index > 0){
    index--;
    nextLearn("back");
  }
}

function toggleMute(){
  muted = !muted;
  const btn = document.getElementById("muteBtn");
  if (btn) btn.innerHTML = muted ? SVG_MUTE : SVG_UNMUTE;
}

function showLearnEnd(){
  setNav("");
  const html = `
    <div class="title-screen">
      <div class="title-content">
        <img src="commandment_images/commandment_title.png">
        <h2>Great job!</h2>
        <div class="title-buttons">
          <button class="learn-btn" onclick="titleScreen()">Title Screen</button>
          <button class="test-btn" onclick="modeSelect()">Test Yourself</button>
        </div>
      </div>

      <div class="footer">
        More free Bible resources at:<br>
        <a href="https://www.eatyourbible.com" target="_blank" style="color:white;">
        www.eatyourbible.com</a>
      </div>
    </div>`;
  showSlide(html, "#7f66c6");
}

/* ---------- Dig Deeper Mode ---------- */
function showDigDeeperIntro(){
  digIntro = true;
  setNav("");
  showSlide(`
    <div class="content">
      <div class="text-area">
        <div>
          <div class="large-text">Dig deeper into each commandment</div>
          <div class="small-text">Tap the Dig Deeper button to learn more about each commandment.</div>

          <div class="title-buttons">
            <button class="learn-btn" onclick="beginDigDeeper()">Begin</button>
          </div>
        </div>
      </div>
    </div>`, "#7f66c6");
}

function startDigDeeper(){
  unlockAudioForIOS();
  screen="dig";
  index=0;
  digDeeperOpen=false;
  showDigDeeperIntro();
}

function beginDigDeeper(){
  digIntro = false;
  renderDigDeeper("forward");
}

function openDigDeeper(){
  if (digDeeperOpen) return;
  digDeeperOpen = true;
  renderDigDeeper("none");
  // Reset scroll to top after render
  setTimeout(()=>{
    const sc = document.getElementById("digScroll");
    const fade = document.querySelector(".dig-fade");
    if (!sc) return;

    // Always start at the top
    sc.scrollTop = 0;

    // Make sure fade is visible at first
    if (fade) fade.classList.remove("hidden");

    // Hide fade once the user scrolls even a little
    sc.addEventListener("scroll", function onScroll(){
  const nearBottom = sc.scrollTop + sc.clientHeight >= sc.scrollHeight - 10;
  if (nearBottom){
    if (fade) fade.classList.add("hidden");
    sc.removeEventListener("scroll", onScroll);
  }
}, { passive:true });
  }, 0);
  


}

function closeDigDeeper(){
  if (!digDeeperOpen) return;
  digDeeperOpen = false;
  renderDigDeeper("none");
}

function forwardDigDeeper(){
  if (digDeeperOpen) return; // lock navigation while open
  index++;
  digDeeperOpen=false;

  if (index >= COMMANDMENTS.length){
    showDigDeeperEnd();
    return;
  }
  renderDigDeeper("forward");
}

function prevDigDeeper(){
  if (digDeeperOpen) return; // lock navigation while open
  if (index > 0){
    index--;
    digDeeperOpen=false;
    renderDigDeeper("back");
  }
}

function renderDigDeeper(direction="forward"){
  const phrase = COMMANDMENTS[index][0];
  const color = getColor(index);

  const textClass = isLightBg(color) ? "phrase dark-text" : "phrase";
  const btnLabel = digDeeperOpen ? "Close" : "Dig Deeper";

  const explRaw = DIG_DEEPER_TEXT[index] || "Put explanation text here.";

  // Support both real newlines and typed "\n" sequences inside strings.
  const expl = String(explRaw).replaceAll("\\n", "\n");

  const paragraphs = expl.split(/\n\s*\n/).map(p => p.trim()).filter(Boolean);

  const digOverlay = digDeeperOpen ? `
    <div class="dig-modal" onclick="/* click-through disabled */">
      <div class="dig-modal-inner">
        <div class="dig-modal-title">Commandment ${index+1}</div>
        <div class="dig-modal-scroll" id="digScroll">
          ${paragraphs.map(p => `<p class="dig-p">${formatDigText(p)}</p>`).join("")}
        </div>
        <div class="dig-fade"></div>
        </div>
      </div>
    </div>
  ` : "";

  const html = `
    <div class="content">
      <div class="image-area" onclick="${digDeeperOpen ? "" : "forwardDigDeeper()"}">
        <img src="commandment_images/commandment_${String(index+1).padStart(2,'0')}.png">
      </div>

      <div class="text-area">
        <div class="${textClass}">${phrase}</div>
      </div>

      ${digOverlay}
    </div>
  `;

  setNav(`
    <button class="no-zoom" onclick="prevDigDeeper()" aria-label="Back">${SVG_BACK}</button>

    <button class="no-zoom" onclick="${digDeeperOpen ? "return" : "titleScreen()"}" aria-label="Home">
      ${SVG_HOME}
    </button>

    <button class="center-btn nav-pill no-zoom" id="digBtn" onclick="${digDeeperOpen ? "closeDigDeeper()" : "openDigDeeper()"}" aria-label="Dig Deeper toggle">
      ${btnLabel}
    </button>

    <button class="no-zoom" onclick="forwardDigDeeper()" aria-label="Forward">${SVG_FORWARD}</button>
  `);

  showSlide(html, color, direction);

}

function showDigDeeperEnd(){
  setNav("");
  const html = `
    <div class="title-screen">
      <div class="title-content">
        <img src="commandment_images/commandment_title.png">
        <h2>Great job!</h2>
        <div class="title-buttons">
          <button class="learn-btn" onclick="titleScreen()">Title Screen</button>
          <button class="test-btn" onclick="modeSelect()">Test Yourself</button>
        </div>
      </div>

      <div class="footer">
        More free Bible resources at:<br>
        <a href="https://www.eatyourbible.com" target="_blank" style="color:white;">
        www.eatyourbible.com</a>
      </div>
    </div>`;
  showSlide(html, "#7f66c6");
}

/* ---------- Test Mode ---------- */
function modeSelect(){
  screen="mode";
  const html = `
    <div class="title-screen">
      <div class="title-content">
        <h2>Choose a mode</h2>

        <div class="title-buttons mode-buttons">
          <button class="learn-btn" onclick="startTest('easy')">
            Easy
            <span class="btn-desc">Guess 1 missing word</span>
          </button>

          <button class="test-btn" onclick="startTest('medium')">
            Medium
            <span class="btn-desc">More words go missing</span>
          </button>

          <button class="hard-btn" onclick="startTest('hard')">
            Hard
            <span class="btn-desc">Pictures only</span>
          </button>

          <button class="learn-btn" onclick="titleScreen()">
            Back to Title
          </button>
        </div>
      </div>

      <div class="footer">
        More free Bible resources at:<br>
        <a href="https://www.eatyourbible.com" target="_blank" style="color:white;">
        www.eatyourbible.com</a>
      </div>
    </div>`;
  document.getElementById("app").innerHTML = html;
  setNav("");
}

function startTest(mode){
  screen="test";
  testMode=mode;
  index=0;
  hintState=0;
  nextTest();
}

function nextTest(){
  if (index >= COMMANDMENTS.length){
    showTestEnd();
    return;
  }
  hintState=0;
  renderTest();
}

function renderTest(direction="forward"){
  const phraseData = COMMANDMENTS[index];
  const phrase = phraseData[0];

  let remove = [];
  if (testMode === "easy") remove = [phraseData[1]];
  if (testMode === "medium") remove = phraseData.slice(1);

  let displayPhrase = phrase;

  if (testMode === "hard" && hintState === 0) displayPhrase = "";
  else if (testMode === "hard" && hintState === 1) displayPhrase = maskPhrase(phrase, phraseData.slice(1), 0);
  else if (testMode === "hard" && hintState === 2) displayPhrase = phrase;
  else displayPhrase = maskPhrase(phrase, remove, hintState);

  const color = getColor(index);
  const textClass = isLightBg(color) ? "phrase dark-text" : "phrase";

  const html = `
    <div class="content">
      <div class="image-area" onclick="forwardTest()">
        <img src="commandment_images/commandment_${String(index+1).padStart(2,'0')}.png">
      </div>

      <div class="text-area">
        <div class="${textClass}" id="testPhrase">${displayPhrase}</div>
      </div>
    </div>
  `;

  setNav(`
    <button class="no-zoom" onclick="prevTest()" aria-label="Back">${SVG_BACK}</button>

    <button class="no-zoom" onclick="titleScreen()" aria-label="Home">
      ${SVG_HOME}
    </button>

    <button class="center-btn nav-pill no-zoom" id="hintBtn" onclick="hint()">
      ${hintState === 0 ? "Hint" : "Reveal"}
    </button>

    <button class="no-zoom" onclick="forwardTest()" aria-label="Forward">${SVG_FORWARD}</button>
  `);

  showSlide(html, color, direction);
}

function hint(){
  if (hintState < 2) hintState++;
  updateTestHintUI();
}

function forwardTest(){
  index++;
  hintState=0;
  if (index >= COMMANDMENTS.length){
    showTestEnd();
    return;
  }
  renderTest("forward");
}

function prevTest(){
  if (index > 0){
    index--;
    hintState=0;
    renderTest("back");
  }
}

function showTestEnd(){
  setNav("");
  const html = `
    <div class="title-screen">
      <div class="title-content">
        <img src="commandment_images/commandment_title.png">
        <h2>Great job!</h2>
        <div class="title-buttons">
          <button class="learn-btn" onclick="modeSelect()">Change Mode</button>
          <button class="test-btn" onclick="titleScreen()">Title Screen</button>
        </div>
      </div>

      <div class="footer">
        More free Bible resources at:<br>
        <a href="https://www.eatyourbible.com" target="_blank" style="color:white;">
        www.eatyourbible.com</a>
      </div>
    </div>`;
  showSlide(html, "#7f66c6");
}

/* ---------- Helpers ---------- */
function escapeHtml(str){
  return String(str)
    .replaceAll("&","&amp;")
    .replaceAll("<","&lt;")
    .replaceAll(">","&gt;")
    .replaceAll('"',"&quot;")
    .replaceAll("'","&#039;");
}

function formatDigText(str){
  let safe = escapeHtml(str);

  // Bold using **text**
  safe = safe.replace(/\*\*(.*?)\*\*/g, "<strong>$1</strong>");

  // Italic using *text*
  safe = safe.replace(/\*(.*?)\*/g, "<em>$1</em>");

  return safe;
}

/* ---------- Start ---------- */
setupKeyboardNav();
preventDoubleTapZoomOnButtons();
preloadCommandmentImages(5);
introScreen();

/* ---- PWA: register service worker ---- */
if ("serviceWorker" in navigator) {
  window.addEventListener("load", () => {
    navigator.serviceWorker
      .register("/eatyourbible/pwa/commandments/sw.js")
      .catch(() => {});
  });
}


</script>
</body>
</html>
