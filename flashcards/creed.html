<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@400;700&display=swap" rel="stylesheet">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
<title>Apostles Creed</title>

<style>

/* Global box sizing fix */
*, *::before, *::after {
    box-sizing: border-box;
}

html, body {
    margin: 0;
    padding: 0;
    height: 100%;
    overflow: hidden;
    font-family: "Baloo 2", system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
}

#app {
    position: relative;
    width: 100%;
    height: 100%;
    overflow: hidden;
}

/* ---------- Slide System ---------- */
.slide {
    position: absolute;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    display: flex;
    flex-direction: column;
    min-height: 0;   /* iOS Safari flex fix */
}

.content {
    flex: 1;
    display: flex;
    flex-direction: column;
    min-height: 0;   /* iOS Safari flex fix */
}

.image-area {
    flex: 1;
    display: flex;
    justify-content: center;
    align-items: center;
    cursor: pointer;
    min-height: 0;
}

.image-area img {
    max-height: 100%;
    max-width: min(90vw, 520px);
    object-fit: contain;
}

.text-area {
    flex: 1;
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 0 20px;
    text-align: center;
    min-height: 0;
}

/* ---------- Verse Proofs Layout Toggle ---------- */

/* Smoothly resize image/text areas when Verse mode is on */
.image-area,
.text-area {
    transition: flex 0.25s ease;
}

/* When Verse mode is ON: image 25% / text 75% */
.content.verse-open .image-area { flex: 1; }
.content.verse-open .text-area  { flex: 3; }

/* Verse proof text layout (arrows + verse text) */
.verse-wrap {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 12px;
    width: 100%;
}

.verse-arrow {
    width: 48px;
    height: 48px;
    border-radius: 999px;
    border: none;
    background: rgba(0,0,0,0.25);
    color: white;

    display: flex;
    align-items: center;
    justify-content: center;

    font-size: 26px;
    font-weight: 700;
    line-height: 0;
}

/* Verse content (reference + text) */
.verse-content {
    flex: 1;
    min-width: 0;
}

.verse-ref {
    font-size: clamp(18px, 4vw, 30px);
    font-weight: 700;
    opacity: 0.9;
    margin-bottom: 8px;
    color: white;
    text-shadow: 0 2px 6px rgba(0,0,0,0.4);
    background: rgba(0, 0, 0, 0.5);
    display: inline-block;
    padding: 6px 20px;
    border-radius: 999px;
    text-align: center;
}

.verse-text {
    font-size: clamp(18px, 4vw, 40px);
    font-weight: 700;
    text-wrap: balance;
    color: white;
    text-shadow: 0 2px 6px rgba(0,0,0,0.4);
}


.phrase {
    font-family: 'Baloo 2', cursive;
    font-size: clamp(24px, 8vw, 100px);
    text-wrap: balance;
    color: white;
    font-weight: 700;
    text-shadow: 0 2px 6px rgba(0,0,0,0.4);
}

/* Use on light backgrounds (yellow/white) */
.dark-text {
    color: #111;
    text-shadow: none;
}

/* Verse reference should always be white (even on light pages) */
.verse-ref.dark-text {
    color: white !important;
    text-shadow: none !important; /* optional */
}


.small-text {
    font-size: clamp(16px, 3vw, 20px);
    opacity: .85;
    color: white;
    text-wrap: balance;
}

.large-text {
    font-size: clamp(28px, 6vw, 48px);
    color: white;
    font-weight: 700;
    text-wrap: balance;
}

/* ---------- Navigation ---------- */

.nav {
    height: 70px;
    background: rgba(0,0,0,0.3);
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0 30px;
    color: white;
    font-size: 28px;
}

.nav button {
    background: none;
    border: none;
    color: white;
    font-size: 28px;
}

/* SVG icon sizing inside nav buttons */
.nav-icon {
    width: 34px;
    height: 34px;
    display: block;
}

.nav button {
    display: flex;
    align-items: center;
    justify-content: center;
}

.center-btn {
    font-size: 18px !important;
}

/* Pressable white pill buttons for Hint/Verse */
.nav-pill {
    background: white !important;
    color: #333333 !important;
    border: none;
    border-radius: 999px;

    padding: 10px 18px;
    font-size: 18px;
    font-weight: 700;

    box-shadow: 0 4px 0 rgba(0,0,0,0.25);
    transition: transform 0.12s ease, box-shadow 0.12s ease;
}

/* Pressed-down effect */
.nav-pill:active {
    transform: translateY(3px);
    box-shadow: 0 1px 0 rgba(0,0,0,0.25);
}

/* ---------- Title ---------- */

.title-screen {
    position: relative;           /* IMPORTANT: allows the footer to dock inside */
    display: flex;
    flex-direction: column;
    align-items: center;
    height: 100%;
    padding: 24px 16px;
    padding-bottom: 110px;        /* IMPORTANT: reserves space for the docked footer */
    background: #7f66c6;
    color: white;
    text-align: center;
}

.title-content {
    flex: 1;                      /* takes available space */
    display: flex;
    flex-direction: column;
    justify-content: center;      /* centers vertically */
    align-items: center;
    width: 100%;
    max-width: 700px;             /* nice on desktop */
    padding-bottom: 0px;         /* breathing room above footer */
}

.title-screen h2 {
    font-size: clamp(22px, 5.2vw, 44px);
    font-weight: 700;
    margin: 14px 0 12px;
    text-wrap: balance;
}

.title-screen img {
    width: min(80%, 420px);
    max-height: 34vh;   /* prevents it from eating the whole screen */
    object-fit: contain;
}

.title-buttons button {
    margin: 10px 8px;
    padding: 14px 28px;
    font-size: 18px;
    font-weight: 700;

    border-radius: 999px;              /* pill shape */
    border: none;

    background: white;
    color: #7f66c6;

    box-shadow: 0 6px 0 rgba(0,0,0,0.25);
    transition: all 0.15s ease;
}

.title-buttons button:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 0 rgba(0,0,0,0.25);
}

.title-buttons button:active {
    transform: translateY(4px);
    box-shadow: 0 2px 0 rgba(0,0,0,0.25);
}

.title-buttons button.carousel-arrow:hover,
.title-buttons button.carousel-arrow:active {
    box-shadow: none;
    transform: none;
}

.learn-btn {
    background: white;
    color: #7f66c6;
}

.test-btn {
    background: #ffc751;
    color: #333;
}

/* ---------- Title Button Carousel ---------- */

.title-carousel {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    width: 100%;
}

.title-buttons button.carousel-arrow {
    width: 54px;
    height: 54px;
    padding: 0;
    margin: 10px 0;
    border-radius: 999px;

    background: rgba(0,0,0,0.30);
    color: white;

    display: flex;              /* ✅ center the SVG */
    align-items: center;
    justify-content: center;
    line-height: 0;             /* ✅ remove baseline weirdness */
    font-size: 28px;
    font-weight: 700;
    box-shadow: none;
    transform: none;
}

.title-buttons button.carousel-main {
    margin: 10px 0;
    flex: 1;                   /* ✅ take remaining space */
    min-width: 0;              /* ✅ allow shrinking on small screens */
    max-width: 420px;          /* ✅ still nice on desktop */
}

/* Dots under the carousel */
.carousel-dots {
    display: flex;
    justify-content: center;
    gap: 10px;
    margin-top: 6px;
}

.carousel-dot {
    width: 10px;
    height: 10px;
    border-radius: 999px;
    border: 2px solid rgba(255,255,255,0.75);
    opacity: 0.9;
}

.carousel-dot.active {
    background: rgba(255,255,255,0.95);
}

/* ---------- Mode Select (title-style buttons) ---------- */

.mode-buttons {
    display: flex;
    flex-direction: column;   /* stack buttons */
    align-items: center;
    width: 100%;
    gap: 14px;
    margin-top: 10px;
}

.mode-buttons button {
    width: min(420px, 92%);
    display: flex;
    flex-direction: column;   /* title + description */
    gap: 4px;
    line-height: 1.1;
}

.mode-buttons .btn-desc {
    font-size: 14px;
    font-weight: 500;
    opacity: 0.85;
}

/* third color option for Hard */
.hard-btn {
    background: #ff5a51;
    color: white;
}

.footer {
    position: absolute;           /* dock it */
    left: 0;
    right: 0;
    bottom: 0;

    background: rgba(0,0,0,0.30); /* matches your nav style */
    color: white;
    text-align: center;

    padding: 12px 16px calc(12px + env(safe-area-inset-bottom));
    font-size: 14px;
    line-height: 1.2;
    z-index: 9999;
}

/* ---------- Intro ---------- */

.intro {
    background: #7f66c6;
    display: flex;  
    justify-content: center;
    align-items: center;
    height: 100%;
}

.intro img {
    width: 60%;
    max-width: 400px;
    animation: wiggle 1s infinite alternate;
}

@keyframes wiggle {
    0% { transform: rotate(-4deg); }
    100% { transform: rotate(4deg); }
}



button {
    cursor: pointer;
    font-family: inherit;
}

/* Prevent mobile double-tap zoom on specific controls */
.no-zoom {
    touch-action: manipulation;
    -webkit-user-select: none;
    user-select: none;
    -webkit-touch-callout: none;
}

</style>
</head>
<body>

<div id="app"></div>

<script>
/* ---------- Data ---------- */

const phrases = [
["I believe in God", "believe", "God"],
["The Father Almighty", "Father", "Almighty"],
["Creator of Heaven and Earth", "Creator", "Earth"],
["I believe in Jesus Christ", "Jesus", "believe"],
["His Only Son, our Lord.", "Son", "Lord"],
["He was conceived by the Holy Spirit", "Spirit", "conceived"],
["and born of the virgin Mary.", "born", "Mary"],
["He suffered under Pontius Pilate", "suffered", "Pilate"],
["was crucified", "crucified"],
["died, and was buried.", "buried", "died"],
["He descended to the dead.", "dead", "descended"],
["On the third day", "third"],
["He rose from the dead.", "rose", "dead"],
["He ascended to heaven", "ascended", "heaven"],
["and is seated at the right hand", "seated", "right"],
["of God the Father Almighty.", "God", "Almighty"],
["From there he will come", "come", "there"],
["to judge", "judge"],
["the living and the dead.", "living", "dead"],
["I believe in the Holy Spirit", "Spirit", "believe"],
["the holy catholic church", "church", "holy"],
["the communion of saints", "communion", "saints"],
["the forgiveness of sins", "forgiveness", "sins"],
["the resurrection of the body", "resurrection", "body"],
["and the life everlasting.", "life", "everlasting"]
];

// ---------- Verse Proofs (dummy placeholders you can edit) ----------
// One entry per creed page (25 total). Each page has 1+ verse proofs.
// Replace the "text" values with full verse text later.
const verseProofs = [

  [ { ref: "HEBREWS 11:6", text: "And without faith it is impossible to please God, because anyone who comes to him must believe that he exists and that he rewards those who earnestly seek him." }, { ref: "GENESIS 1:1", text: "In the beginning God created the heavens and the earth." } ],

  [ { ref: "MATTHEW 6:9", text: "This, then, is how you should pray: Our Father in heaven, hallowed be your name." }, { ref: "REVELATION 1:8", text: "I am the Alpha and the Omega,” says the Lord God, “who is, and who was, and who is to come, the Almighty." } ],

  [ { ref: "PSALM 146:6", text: "He is the Maker of heaven and earth, the sea, and everything in them — he remains faithful forever." }, { ref: "ACTS 4:24", text: "When they heard this, they raised their voices together in prayer to God. 'Sovereign Lord,' they said, 'you made the heavens and the earth and the sea, and everything in them.'" } ],

  [ { ref: "JOHN 20:31", text: "But these are written that you may believe that Jesus is the Messiah, the Son of God, and that by believing you may have life in his name." }, { ref: "MATTHEW 16:16", text: "Simon Peter answered, 'You are the Messiah, the Son of the living God.'" } ],

  [ { ref: "1 JOHN 4:15", text: "If anyone acknowledges that Jesus is the Son of God, God lives in them and they in God." }, { ref: "ROMANS 10:9", text: "If you declare with your mouth, 'Jesus is Lord,' and believe in your heart that God raised him from the dead, you will be saved." } ],

  [ { ref: "LUKE 1:35", text: "The angel answered, 'The Holy Spirit will come on you, and the power of the Most High will overshadow you. So the holy one to be born will be called the Son of God.'" }, { ref: "MATTHEW 1:20", text: "But after he had considered this, an angel of the Lord appeared to him in a dream and said, 'Joseph son of David, do not be afraid to take Mary home as your wife, because what is conceived in her is from the Holy Spirit.'" } ],

  [ { ref: "ISAIAH 7:14", text: "Therefore the Lord himself will give you a sign: The virgin will conceive and give birth to a son, and will call him Immanuel." }, { ref: "LUKE 2:7", text: "and she gave birth to her firstborn, a son. She wrapped him in cloths and placed him in a manger, because there was no guest room available for them." } ],

  [ { ref: "MATTHEW 27:26", text: "Then he released Barabbas to them. But he had Jesus flogged, and handed him over to be crucified." }, { ref: "1 TIMOTHY 6:13", text: "In the sight of God, who gives life to everything, and of Christ Jesus, who while testifying before Pontius Pilate made the good confession, I charge you..." } ],

  [ { ref: "LUKE 23:33", text: " When they came to the place called the Skull, they crucified him there, along with the criminals—one on his right, the other on his left." }, { ref: "MATTHEW 27:35", text: "When they had crucified him, they divided up his clothes by casting lots." } ],

  [ { ref: "1 CORINTHIANS 15:3-4", text: "For what I received I passed on to you as of first importance: that Christ died for our sins according to the Scriptures, that he was buried..." }, { ref: "MARK 15:46", text: "So Joseph bought some linen cloth, took down the body, wrapped it in the linen, and placed it in a tomb cut out of rock. Then he rolled a stone against the entrance of the tomb." } ],

  [ { ref: "ACTS 2:31", text: "Seeing what was to come, he spoke of the resurrection of the Messiah, that he was not abandoned to the realm of the dead, nor did his body see decay." }, { ref: "1 PETER 3:18-19", text: "For Christ also suffered once for sins, the righteous for the unrighteous, to bring you to God. He was put to death in the body but made alive in the Spirit. After being made alive, he went and made proclamation to the imprisoned spirits..." } ],

  [ { ref: "1 CORINTHIANS 15:4", text: "...he was raised on the third day according to the Scriptures..." }, { ref: "ACTS 10:40", text: "...but God raised him from the dead on the third day and caused him to be seen." } ],

  [ { ref: "MATTHEW 28:6", text: "He is not here; he has risen, just as he said. Come and see the place where he lay." }, { ref: "ACTS 2:24", text: "But God raised him from the dead, freeing him from the agony of death, because it was impossible for death to keep its hold on him." } ],

  [ { ref: "ACTS 1:9", text: "After he said this, he was taken up before their very eyes, and a cloud hid him from their sight." }, { ref: "LUKE 24:51", text: "While he was blessing them, he left them and was taken up into heaven." } ],

  [ { ref: "HEBREWS 1:3", text: "The Son is the radiance of God’s glory and the exact representation of his being, sustaining all things by his powerful word. After he had provided purification for sins, he sat down at the right hand of the Majesty in heaven." }, { ref: "COLOSSIANS 3:1", text: "Since, then, you have been raised with Christ, set your hearts on things above, where Christ is, seated at the right hand of God." } ],

  [ { ref: "PSALM 110:1", text: "The Lord says to my lord: 'Sit at my right hand until I make your enemies a footstool for your feet.'" }, { ref: "ROMANS 8:34", text: "Who then is the one who condemns? No one. Christ Jesus who died—more than that, who was raised to life — is at the right hand of God and is also interceding for us." } ],

  [ { ref: "ACTS 1:11", text: "'Men of Galilee,' they said, 'why do you stand here looking into the sky? This same Jesus, who has been taken from you into heaven, will come back in the same way you have seen him go into heaven.'" }, { ref: "1 THESSALONIANS 4:16", text: "For the Lord himself will come down from heaven, with a loud command, with the voice of the archangel and with the trumpet call of God, and the dead in Christ will rise first." } ],

  [ { ref: "2 TIMOTHY 4:1", text: "In the presence of God and of Christ Jesus, who will judge the living and the dead, and in view of his appearing and his kingdom, I give you this charge:" }, { ref: "JOHN 5:27", text: "And he has given him authority to judge because he is the Son of Man." } ],

  [ { ref: "ACTS 10:42", text: "He commanded us to preach to the people and to testify that he is the one whom God appointed as judge of the living and the dead." }, { ref: "1 PETER 4:5", text: "But they will have to give account to him who is ready to judge the living and the dead." } ],

  [ { ref: "JOHN 14:26", text: "But the Advocate, the Holy Spirit, whom the Father will send in my name, will teach you all things and will remind you of everything I have said to you." }, { ref: "1 CORINTHIANS 3:16", text: "Don’t you know that you yourselves are God’s temple and that God’s Spirit dwells in your midst?" } ],

  [ { ref: "COLOSSIANS 1:18", text: "And he is the head of the body, the church; he is the beginning and the firstborn from among the dead, so that in everything he might have the supremacy." }, { ref: "1 PETER 2:9", text: "But you are a chosen people, a royal priesthood, a holy nation, God’s special possession, that you may declare the praises of him who called you out of darkness into his wonderful light. " } ],

  [ { ref: "1 CORINTHIANS 12:12-13", text: "Just as a body, though one, has many parts, but all its many parts form one body, so it is with Christ. For we were all baptized by one Spirit so as to form one body—whether Jews or Gentiles, slave or free—and we were all given the one Spirit to drink." }, { ref: "HEBREWS 12:1", text: "Therefore, since we are surrounded by such a great cloud of witnesses, let us throw off everything that hinders and the sin that so easily entangles. And let us run with perseverance the race marked out for us," } ],

  [ { ref: "EPHESIANS 1:7", text: "...In him we have redemption through his blood, the forgiveness of sins, in accordance with the riches of God’s grace..." }, { ref: "1 JOHN 1:9", text: "If we confess our sins, he is faithful and just and will forgive us our sins and purify us from all unrighteousness." } ],

  [ { ref: "1 CORINTHIANS 15:42-44", text: "So will it be with the resurrection of the dead. The body that is sown is perishable, it is raised imperishable; it is sown in dishonor, it is raised in glory; it is sown in weakness, it is raised in power; it is sown a natural body, it is raised a spiritual body." }, { ref: "JOHN 5:28-29", text: "Do not be amazed at this, for a time is coming when all who are in their graves will hear his voice and come out—those who have done what is good will rise to live, and those who have done what is evil will rise to be condemned." } ],

  [ { ref: "JOHN 3:16", text: "For God so loved the world that he gave his one and only Son, that whoever believes in him shall not perish but have eternal life." }, { ref: "ROMANS 6:23", text: "For the wages of sin is death, but the gift of God is eternal life in Christ Jesus our Lord." } ]

];

const slideColors = [
"#7f66c6", // 1 - purple
"#ffc751", // 2 - yellow
"#333333", // 3 - gray
"#ffa351", // 4 - orange
"#a7cb6f", // 5 - green
"#ff5a51", // 6 - red
"#ffc751", // 7 - yellow
"#40b9c5", // 8 - blue
"#ff5a51", // 9 - red
"#f2f2f2", // 10 - white
"#333333", // 11 - gray
"#ffa351", // 12 - orange
"#a7cb6f", // 13 - green
"#40b9c5", // 14 - blue
"#ffc751", // 15 - yellow
"#7f66c6", // 16 - purple
"#40b9c5", // 17 - blue
"#ffa351", // 18 - orange
"#7f66c6", // 19 - purple
"#ffc751", // 20 - yellow
"#f2f2f2", // 21 - white
"#a7cb6f", // 22 - green
"#ff5a51", // 23 - red
"#a7cb6f", // 24 - green
"#7f66c6"  // 25 - purple
];

let screen="intro";
let index=0;
let muted=false;
let testMode=null;
let hintState=0;
let learnIntro = false;  // true only on the "Begin" screen
let verseIntro = false;  // true only on the Verse Proofs "Begin" screen
let isSliding = false;   // prevents overlapping slide animations

// ---------- Verse Proofs state ----------
let verseModeOpen = false;   // toggled by Verse button
let verseProofIndex = 0;     // which verse within the page

// ---------- Title carousel ----------
let titleOptionIndex = 0;

const TITLE_OPTIONS = [
    { label: "Learn the Creed", btnClass: "learn-btn", action: "startLearn" },
    { label: "Test Yourself",   btnClass: "test-btn",  action: "modeSelect" },
    { label: "Verse Proofs", btnClass: "learn-btn", action: "startVerseProofs" }
];



function titlePrevOption(){
    titleOptionIndex = (titleOptionIndex - 1 + TITLE_OPTIONS.length) % TITLE_OPTIONS.length;
    updateTitleCarouselUI();
}

function titleNextOption(){
    titleOptionIndex = (titleOptionIndex + 1) % TITLE_OPTIONS.length;
    updateTitleCarouselUI();
}

function runTitleOption(){
    const opt = TITLE_OPTIONS[titleOptionIndex];
    // Call the function named in opt.action
    window[opt.action]();
}

function updateTitleCarouselUI(){
    const opt = TITLE_OPTIONS[titleOptionIndex];

    const mainBtn = document.getElementById("titleMainBtn");
    const indicator = document.getElementById("titleIndicator");

    if (mainBtn){
        mainBtn.textContent = opt.label;
        mainBtn.className = `carousel-main ${opt.btnClass}`;
    }
    if (indicator){
        indicator.innerHTML = TITLE_OPTIONS.map((_, i) =>
            `<span class="carousel-dot ${i === titleOptionIndex ? "active" : ""}"></span>`
        ).join("");
    }
}

// --- Inline SVG icons (from your uploaded SVGs) ---
const SVG_BACK = `
<svg class="nav-icon" viewBox="0 0 1270 889" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false">
  <path style="fill:#ffffff;stroke-width:74.9031;stroke-linecap:round"
    d="M 90.101697,426.07323 665.52324,88.164306 a 20.830539,20.830539 29.78848 0 1 31.37872,17.962384 v 676.74658 a 20.830539,20.830539 150.21152 0 1 -31.37872,17.96238 L 90.101697,462.92673 a 21.369052,21.369052 90 0 1 0,-36.8535 z"
    transform="translate(246.77226)" />
</svg>`;

const SVG_FORWARD = `
<svg class="nav-icon" viewBox="0 0 1270 889" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false">
  <path style="fill:#ffffff;stroke-width:74.9031;stroke-linecap:round"
    d="M 90.101697,426.07323 665.52324,88.164306 a 20.830539,20.830539 29.78848 0 1 31.37872,17.962384 v 676.74658 a 20.830539,20.830539 150.21152 0 1 -31.37872,17.96238 L 90.101697,462.92673 a 21.369052,21.369052 90 0 1 0,-36.8535 z"
    transform="matrix(-1,0,0,1,1023.2277,0)" />
</svg>`;

const SVG_MUTE = `
<svg class="nav-icon" viewBox="0 0 1270 889" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false">
  <path style="fill:#ffffff;stroke:none;stroke-width:44.9431;stroke-linecap:round"
    d="M 660.98465,87.244161 409.97079,241.6972 a 150.47802,150.47802 0 0 1 -78.85883,22.31829 H 225.63234 a 42.587633,42.587633 0 0 0 -42.58762,42.58762 v 275.79372 a 42.587633,42.587633 0 0 0 42.58762,42.58762 h 105.47962 a 150.47802,150.47802 0 0 1 78.85883,22.3183 l 251.01386,154.45304 a 23.799138,23.799138 0 0 0 36.27121,-20.26933 V 107.51349 A 23.799138,23.799138 0 0 0 660.98465,87.244161 Z" />
  <g transform="translate(-26.458334,-255.59263)">
    <path style="fill:none;stroke:#ffffff;stroke-width:76.7747;stroke-linecap:round;stroke-dasharray:none;stroke-opacity:1"
      d="M 1241.4124,524.69155 890.61025,875.49365" />
    <path style="fill:none;stroke:#ffffff;stroke-width:76.7747;stroke-linecap:round;stroke-dasharray:none;stroke-opacity:1"
      d="m 890.61025,524.69155 350.80215,350.8021" />
  </g>
</svg>`;

const SVG_UNMUTE = `
<svg class="nav-icon" viewBox="0 0 1270 889" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false">
  <g transform="matrix(2.9017243,0,0,2.9017243,-948.59169,1423.6267)">
    <path style="fill:#ffffff;stroke:none;stroke-width:15.4884;stroke-linecap:round"
      d="m 554.69651,-460.54773 -86.50507,53.22802 a 51.858137,51.858137 0 0 1 -27.17654,7.69139 h -36.35067 a 14.676664,14.676664 0 0 0 -14.67666,14.67666 v 95.04477 a 14.676664,14.676664 0 0 0 14.67666,14.67666 h 36.35067 a 51.858137,51.858137 0 0 1 27.17654,7.69139 l 86.50507,53.22802 a 8.2017227,8.2017227 0 0 0 12.49988,-6.98527 v -232.26637 a 8.2017227,8.2017227 0 0 0 -12.49988,-6.98527 z" />
    <path style="fill:none;stroke:#ffffff;stroke-width:26.4583;stroke-linecap:round;stroke-dasharray:none;stroke-opacity:1"
      d="m 596.38634,-270.01659 c 26.00162,-13.81364 42.0863,-39.52797 42.16745,-67.41243 -0.0102,-27.95044 -16.10446,-53.75052 -42.16745,-67.5969" />
    <path style="fill:none;stroke:#ffffff;stroke-width:26.4583;stroke-linecap:round;stroke-dasharray:none;stroke-opacity:1"
      d="m 626.65943,-233.57231 c 4.34269,-2.51562 16.69789,-10.99898 23.86366,-17.76894 23.32002,-22.03191 37.74343,-52.46821 37.74343,-86.08777 0,-33.61956 -14.42341,-64.05637 -37.74343,-86.08828 -7.16577,-6.76996 -19.52097,-15.25332 -23.86366,-17.76894" />
  </g>
</svg>`;


// Reuse one audio player (important for iPhone autoplay behavior)
const audioPlayer = new Audio();
audioPlayer.preload = "auto";

// After we "unlock" once, later plays are more reliable
let audioUnlocked = false;

/* ---------- Utility ---------- */

function getColor(i){
    return slideColors[i];
}

function isLightBg(color){
    return color === "#ffc751" || color === "#f2f2f2";
}

function preloadCreedImages(priorityCount = 3) {
    // Helper: request an image download without adding it to the DOM
    function requestImage(src) {
        const img = new Image();
        img.src = src;
        // Optional: allow browser to decode when it can
        img.decoding = "async";
    }

    // 1) Preload the intro images used immediately
    requestImage("creed_images/intro_bible.png");
    requestImage("creed_images/intro_bible_bite.png");

    // 2) Preload commonly used screens
    requestImage("creed_images/creed_title.png");
    requestImage("creed_images/creed_end.png");

    // 3) Preload the first N creed slides FIRST (highest priority for UX)
    const total = phrases.length;
    const firstBatch = Math.min(priorityCount, total);

    for (let i = 1; i <= firstBatch; i++) {
        requestImage(`creed_images/creed_${String(i).padStart(2, "0")}.png`);
    }

    // 4) Preload the remaining slides AFTER the first batch
    function preloadRemaining() {
        for (let i = firstBatch + 1; i <= total; i++) {
            requestImage(`creed_images/creed_${String(i).padStart(2, "0")}.png`);
        }
    }

    // Prefer idle time if supported; otherwise wait a tiny bit
    if ("requestIdleCallback" in window) {
        requestIdleCallback(preloadRemaining, { timeout: 1500 });
    } else {
        setTimeout(preloadRemaining, 300);
    }
}

function setupKeyboardNav(){
    document.addEventListener("keydown", (e) => {
        // Don’t spam-move if someone holds the key down
        if (e.repeat) return;

        // Only care about Left/Right arrows
        if (e.key !== "ArrowRight" && e.key !== "ArrowLeft") return;

        // Prevent the browser from scrolling the page
        e.preventDefault();

        // Right arrow = forward
        if (e.key === "ArrowRight") {
            if (screen === "learn") {
                // On the Begin screen, start the lesson (don’t skip phrase 1)
                if (learnIntro) nextLearn("forward");
                else forwardLearn();
            } else if (screen === "test") {
                forwardTest();
            } else if (screen === "verses") {
                if (verseIntro) beginVerseProofs();
            else forwardVerseProofs();
            }
            return;
        }

        // Left arrow = back
        if (e.key === "ArrowLeft") {
            if (screen === "learn") {
                // On Begin screen, go back to title
                if (learnIntro) titleScreen();
                else prevLearn();
            } else if (screen === "test") {
                prevTest();
            } else if (screen === "verses") {
               if (verseIntro) titleScreen();
                else prevVerseProofs();
            }
        }
    });
}

function preventDoubleTapZoomOnButtons(){
    let lastTouchEnd = 0;

    document.addEventListener("touchend", (e) => {
        // Only affect elements marked with .no-zoom
        const btn = e.target.closest(".no-zoom");
        if (!btn) return;

        const now = Date.now();

        // If two taps happen quickly, prevent the second one from zooming
        if (now - lastTouchEnd <= 350) {
            e.preventDefault();
        }

        lastTouchEnd = now;
    }, { passive: false });
}


function playAudio(i){
    if (muted) return;

    audioPlayer.pause();
    audioPlayer.currentTime = 0;
    audioPlayer.src = `creed_audio/creed_${String(i+1).padStart(2,"0")}.mp3`;
    audioPlayer.volume = 1;

    audioPlayer.play().catch(()=>{});
}

function unlockAudioForIOS() {
    if (audioUnlocked) return;

    // Use slide 1 as the unlock source (must exist)
    audioPlayer.src = `creed_audio/creed_01.mp3`;
    audioPlayer.volume = 0;

    // Try to start playback during the user's tap
    const p = audioPlayer.play();
    if (p && typeof p.then === "function") {
        p.then(() => {
            audioPlayer.pause();
            audioPlayer.currentTime = 0;
            audioPlayer.volume = 1;
            audioUnlocked = true;
        }).catch(() => {
            // If it fails, we'll still be fine on later user-gesture plays
        });
    }
}


function maskWord(word, revealLetters=0){
    return word.split("").map((c,i)=>{
        if(c===" ") return " ";
        if(i<revealLetters) return word[i];
        return "_";
    }).join("");
}

function maskPhrase(phrase, removeWords, reveal=0){
    let result=phrase;
    removeWords.forEach(w=>{
        const masked = reveal===2 ? w :
                       reveal===1 ? maskWord(w,1) :
                       maskWord(w,0);
        result = result.replace(new RegExp(w,"i"), masked);
    });
    return result;
}

function computeTestDisplayPhrase() {
    const phraseData = phrases[index];
    const phrase = phraseData[0];

    let remove = [];
    if (testMode === "easy") remove = [phraseData[1]];
    if (testMode === "medium") remove = phraseData.slice(1);

    if (testMode === "hard" && hintState === 0) return "";
    if (testMode === "hard" && hintState === 1) return maskPhrase(phrase, phraseData.slice(1), 0);
    if (testMode === "hard" && hintState === 2) return phrase;

    return maskPhrase(phrase, remove, hintState);
}

function updateTestHintUI() {
    const phraseEl = document.getElementById("testPhrase");
    if (phraseEl) phraseEl.textContent = computeTestDisplayPhrase();

    const hintBtn = document.getElementById("hintBtn");
    if (hintBtn) hintBtn.textContent = (hintState === 0) ? "Hint" : "Reveal";
}

/* ---------- Slide Engine ---------- */

function showSlide(contentHTML, bgColor, direction = "forward") {
    const app = document.getElementById("app");

    // Remove any non-slide screens (like title/mode screens)
    [...app.children].forEach(child => {
        if (!child.classList || !child.classList.contains("slide")) child.remove();
    });

    // If we are mid-animation, ignore new slide requests
    if (direction !== "none" && isSliding) return;

    // Get ALL slides currently in the DOM
    const slides = app.querySelectorAll(".slide");
    const oldSlide = slides.length ? slides[slides.length - 1] : null;

    // If any extra slides exist (shouldn't, but can happen), remove them
    for (let i = 0; i < slides.length - 1; i++) {
        slides[i].remove();
    }

    const newSlide = document.createElement("div");
    newSlide.className = "slide";
    newSlide.style.background = bgColor;
    newSlide.innerHTML = contentHTML;
    newSlide.style.transition = "none";

    // Starting positions based on direction
    if (direction === "back") {
        newSlide.style.transform = "translateX(-100%)";
    } else if (direction === "none") {
        newSlide.style.transform = "translateX(0)";
    } else {
        newSlide.style.transform = "translateX(100%)";
    }

    app.appendChild(newSlide);
    newSlide.offsetHeight; // force layout so the starting transform is committed

    // If no animation requested, just remove old and finish
    if (direction === "none") {
        if (oldSlide) oldSlide.remove();
        isSliding = false;
        return;
    }

    isSliding = true;

    requestAnimationFrame(() => {
        requestAnimationFrame(() => {
            newSlide.style.transition = "transform .4s ease";
            newSlide.style.transform = "translateX(0)";

            if (oldSlide) {
                oldSlide.style.transition = "transform .4s ease";
                oldSlide.style.transform = (direction === "back")
                    ? "translateX(100%)"
                    : "translateX(-100%)";
            }

            setTimeout(() => {
                if (oldSlide) oldSlide.remove();
                isSliding = false;
            }, 410);
        });
    });
}


/* ---------- Screens ---------- */

function introScreen(){
    const html=`
    <div class="intro">
        <img id="introImg" src="creed_images/intro_bible.png">
    </div>`;
    document.getElementById("app").innerHTML=html;

    const img=document.getElementById("introImg");
    img.onclick=()=>{
        img.src="creed_images/intro_bible_bite.png";
        new Audio("creed_audio/chomp.mp3").play();
        setTimeout(()=>titleScreen(),600);
    };
}

function titleScreen(){
    screen="title";
    const html=`
    <div class="title-screen">
        <div class="title-content" id="titleContent">
            <img src="creed_images/creed_title.png">
            <h2>Let's learn the Apostle's Creed</h2>
        <div class="title-buttons">
            <div class="title-carousel">
                <button class="carousel-arrow no-zoom" onclick="titlePrevOption()" aria-label="Previous option">◀</button>


                <button id="titleMainBtn" class="carousel-main learn-btn" onclick="runTitleOption()">
                    Learn the Verse
                </button>

                <button class="carousel-arrow no-zoom" onclick="titleNextOption()" aria-label="Next option">▶</button>
            </div>

            <div class="carousel-dots" id="titleIndicator"></div>
        </div>
        </div>
        <div class="footer">
            More free Bible resources at:<br>
            <a href="https://www.eatyourbible.com" target="_blank" style="color:white;">
            www.eatyourbible.com</a>
        </div>
    </div>`;
    document.getElementById("app").innerHTML=html;
    updateTitleCarouselUI();
}

function startLearn(){
    unlockAudioForIOS();   // <--- add this line
    screen="learn";
    index=0;
    showLearnIntro();
}


function showLearnIntro(){
    learnIntro = true;
    showSlide(`
    <div class="content">
        <div class="text-area">
            <div>
                <div class="large-text">Let's read the Apostles Creed.</div>
                <div class="small-text">Use the arrows to go forward and back.</div>

                <div class="title-buttons">
                    <button class="learn-btn" onclick="nextLearn('forward')">Begin</button>
                </div>
            </div>
        </div>
        <div class="nav"></div>
    </div>`, "#7f66c6");
}

function nextLearn(direction = "forward"){
    learnIntro = false;
    if(index>=phrases.length){
        showLearnEnd();
        return;
    }
    const phrase=phrases[index][0];
    const color=getColor(index);
    const textClass = isLightBg(color) ? "phrase dark-text" : "phrase";
    const html=`
    <div class="content">
        <div class="image-area" onclick="forwardLearn()">
            <img src="creed_images/creed_${String(index+1).padStart(2,"0")}.png">
        </div>
        <div class="text-area">
            <div class="${textClass}">${phrase}</div>
        </div>
    </div>
    <div class="nav">
        <button class="no-zoom" onclick="prevLearn()" aria-label="Back">${SVG_BACK}</button>
        <button class="center-btn" id="muteBtn" onclick="toggleMute()" aria-label="Mute toggle">
            ${muted ? SVG_MUTE : SVG_UNMUTE}
        </button>
        <button class="no-zoom" onclick="forwardLearn()" aria-label="Forward">${SVG_FORWARD}</button>
    </div>`;
    showSlide(html, color, direction);
    playAudio(index);
}

function forwardLearn(){
    index++;
    nextLearn("forward");
}

function prevLearn(){
    if(index>0){
        index--;
        nextLearn("back");
    }
}



function toggleMute(){
    muted = !muted;
    const btn = document.getElementById("muteBtn");
    if (btn) btn.innerHTML = muted ? SVG_MUTE : SVG_UNMUTE;
}


function showLearnEnd(){
    const html=`
    <div class="title-screen">
        <div class="title-content">
            <img src="creed_images/creed_end.png">
            <h2>Great job!</h2>
            <div class="title-buttons">
                <button class="learn-btn" onclick="titleScreen()">Title Screen</button>
                <button class="test-btn" onclick="modeSelect()">Test Yourself</button>
            </div>
        </div>

        <div class="footer">
            More free Bible resources at:<br>
            <a href="https://www.eatyourbible.com" target="_blank" style="color:white;">
            www.eatyourbible.com</a>
        </div>
    </div>`;
    showSlide(html, "#7f66c6");
}

/* ---------- Verse Proofs Mode ---------- */

function showVerseProofsIntro(){
    verseIntro = true;
    showSlide(`
    <div class="content">
        <div class="text-area">
            <div>
                <div class="large-text">Verse proofs for the Apostle&apos;s Creed</div>
                <div class="small-text">For each part of the creed, click the VERSE button to read Bible verses that explain it.</div>

                <div class="title-buttons">
                    <button class="learn-btn" onclick="beginVerseProofs()">Begin</button>
                </div>
            </div>
        </div>
        <div class="nav"></div>
    </div>`, "#7f66c6");
}

function startVerseProofs(){
    unlockAudioForIOS();
    screen = "verses";
    index = 0;
    verseModeOpen = false;
    verseProofIndex = 0;
    showVerseProofsIntro();
}

function beginVerseProofs(){
    verseIntro = false;
    renderVerseProofs("forward");
}

function toggleVerseMode(){
    verseModeOpen = !verseModeOpen;
    verseProofIndex = 0; // always start at the first verse proof
    renderVerseProofs("none"); // re-render without slide animation
}

function nextVerseProof(){
    const proofs = verseProofs[index] || [];
    if (proofs.length <= 1) return;
    verseProofIndex = (verseProofIndex + 1) % proofs.length;
    renderVerseProofs("none");
}

function prevVerseProof(){
    const proofs = verseProofs[index] || [];
    if (proofs.length <= 1) return;
    verseProofIndex = (verseProofIndex - 1 + proofs.length) % proofs.length;
    renderVerseProofs("none");
}

function forwardVerseProofs(){
    index++;
    verseModeOpen = false;   // reset on page change
    verseProofIndex = 0;

    if (index >= phrases.length){
        showVerseProofsEnd();
        return;
    }
    renderVerseProofs("forward");
}

function prevVerseProofs(){
    if (index > 0){
        index--;
        verseModeOpen = false;   // reset on page change
        verseProofIndex = 0;
        renderVerseProofs("back");
    }
}

function renderVerseProofs(direction = "forward"){
    const phrase = phrases[index][0];
    const color = getColor(index);

    const textClass = isLightBg(color) ? "phrase dark-text" : "phrase";
    const verseTextClass = isLightBg(color) ? "verse-text dark-text" : "verse-text";
    const verseRefClass = isLightBg(color) ? "verse-ref dark-text" : "verse-ref";

    const proofs = verseProofs[index] || [];
    const proof = proofs[verseProofIndex] || { ref: "Verse", text: "[Add verse text]" };

    // If Verse mode is OFF: show creed phrase
    let mainTextHTML = `<div class="${textClass}">${phrase}</div>`;

    // If Verse mode is ON: show verse proof carousel
    if (verseModeOpen){
        const showArrows = proofs.length > 1;

        mainTextHTML = `
        <div class="verse-wrap">
            ${showArrows ? `<button class="verse-arrow no-zoom" onclick="prevVerseProof()" aria-label="Previous verse">◀</button>` : `<div style="width:48px;"></div>`}

            <div class="verse-content">
                <div class="${verseRefClass}">${proof.ref}</div>
                <div class="${verseTextClass}">${proof.text}</div>
            </div>

            ${showArrows ? `<button class="verse-arrow no-zoom" onclick="nextVerseProof()" aria-label="Next verse">▶</button>` : `<div style="width:48px;"></div>`}
        </div>`;
    }

    const html = `
    <div class="content ${verseModeOpen ? "verse-open" : ""}">
        <div class="image-area" onclick="forwardVerseProofs()">
            <img src="creed_images/creed_${String(index+1).padStart(2,"0")}.png">
        </div>
        <div class="text-area">
            ${mainTextHTML}
        </div>
    </div>

    <div class="nav">
        <button class="no-zoom" onclick="prevVerseProofs()" aria-label="Back">${SVG_BACK}</button>

        <button class="center-btn nav-pill" id="verseBtn" onclick="toggleVerseMode()" aria-label="Toggle verse mode">
            ${verseModeOpen ? "Creed" : "Verse"}
        </button>

        <button class="no-zoom" onclick="forwardVerseProofs()" aria-label="Forward">${SVG_FORWARD}</button>
    </div>`;

    showSlide(html, color, direction);

    // Optional: play creed audio when not in Verse mode
    if (!verseModeOpen) playAudio(index);
}

function showVerseProofsEnd(){
    const html=`
    <div class="title-screen">
        <div class="title-content">
            <img src="creed_images/creed_end.png">
            <h2>Great job!</h2>
            <div class="title-buttons">
                <button class="learn-btn" onclick="titleScreen()">Title Screen</button>
            </div>
        </div>

        <div class="footer">
            More free Bible resources at:<br>
            <a href="https://www.eatyourbible.com" target="_blank" style="color:white;">
            www.eatyourbible.com</a>
        </div>
    </div>`;
    showSlide(html, "#7f66c6");
}


/* ---------- Test Mode ---------- */

function modeSelect(){
    screen="mode";
    const html=`
    <div class="title-screen">
        <div class="title-content">
            <h2>Choose a mode</h2>

            <div class="title-buttons mode-buttons">
                <button class="learn-btn" onclick="startTest('easy')">
                    Easy
                    <span class="btn-desc">Guess 1 missing word</span>
                </button>

                <button class="test-btn" onclick="startTest('medium')">
                    Medium
                    <span class="btn-desc">More words go missing</span>
                </button>

                <button class="hard-btn" onclick="startTest('hard')">
                    Hard
                    <span class="btn-desc">Images only (no text)</span>
                </button>

                <button class="learn-btn" onclick="titleScreen()">
                    Back to Title
                </button>
            </div>
        </div>

        <div class="footer">
            More free Bible resources at:<br>
            <a href="https://www.eatyourbible.com" target="_blank" style="color:white;">
            www.eatyourbible.com</a>
        </div>
    </div>`;
    document.getElementById("app").innerHTML=html;
}



function startTest(mode){
    screen="test";
    testMode=mode;
    index=0;
    hintState=0;
    nextTest();
}

function nextTest(){
    if(index>=phrases.length){
        showTestEnd();
        return;
    }
    hintState=0;
    renderTest();
}

function renderTest(direction = "forward"){
    const phraseData=phrases[index];
    const phrase=phraseData[0];
    let remove=[];
    if(testMode==="easy") remove=[phraseData[1]];
    if(testMode==="medium") remove=phraseData.slice(1);
    let displayPhrase=phrase;

    if(testMode==="hard" && hintState===0){
        displayPhrase="";
    } else if(testMode==="hard" && hintState===1){
        displayPhrase=maskPhrase(phrase,phraseData.slice(1),0);
    } else if(testMode==="hard" && hintState===2){
        displayPhrase=phrase;
    } else {
        displayPhrase=maskPhrase(phrase,remove,hintState);
    }

    const color=getColor(index);
    const textClass = isLightBg(color) ? "phrase dark-text" : "phrase";
    const html=`
    <div class="content">
        <div class="image-area" onclick="forwardTest()">
            <img src="creed_images/creed_${String(index+1).padStart(2,"0")}.png">
        </div>
        <div class="text-area">
            <div class="${textClass}" id="testPhrase">${displayPhrase}</div>
        </div>
    </div>
    <div class="nav">
        <button class="no-zoom" onclick="prevTest()" aria-label="Back">${SVG_BACK}</button>
        <button class="center-btn nav-pill" id="hintBtn" onclick="hint()">${hintState===0?"Hint":"Reveal"}</button>
        <button class="no-zoom" onclick="forwardTest()" aria-label="Forward">${SVG_FORWARD}</button>
    </div>`;
showSlide(html, color, direction);
}

function hint(){
    if (hintState < 2) hintState++;
    updateTestHintUI(); // no animation
}

function forwardTest(){
    index++;
    hintState = 0; // reset Hint/Reveal for the new page

    // if we went past the last phrase, go to the end screen
    if (index >= phrases.length) {
        showTestEnd();
        return;
    }

    renderTest("forward");
}

function prevTest(){
    if(index > 0){
        index--;
        hintState = 0; // reset Hint/Reveal for the new page
        renderTest("back");
    }
}



function showTestEnd(){
    const html=`
    <div class="title-screen">
        <div class="title-content">
            <img src="creed_images/creed_end.png">
            <h2>Great job!</h2>
            <div class="title-buttons">
                <button class="learn-btn" onclick="modeSelect()">Change Mode</button>
                <button class="test-btn" onclick="titleScreen()">Title Screen</button>
            </div>
        </div>

        <div class="footer">
            More free Bible resources at:<br>
            <a href="https://www.eatyourbible.com" target="_blank" style="color:white;">
            www.eatyourbible.com</a>
        </div>
    </div>`;
    showSlide(html, "#7f66c6");
}



/* ---------- Start ---------- */
setupKeyboardNav();
preventDoubleTapZoomOnButtons();
preloadCreedImages(5);
introScreen();
</script>
</body>
</html>
